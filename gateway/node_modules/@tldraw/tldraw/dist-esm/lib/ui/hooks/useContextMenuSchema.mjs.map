{
  "version": 3,
  "sources": ["../../../../src/lib/ui/hooks/useContextMenuSchema.tsx"],
  "sourcesContent": ["import { Editor, track, useEditor, useValue } from '@tldraw/editor'\nimport React, { useMemo } from 'react'\nimport {\n\tTLUiMenuSchema,\n\tcompactMenuItems,\n\tmenuCustom,\n\tmenuGroup,\n\tmenuItem,\n\tmenuSubmenu,\n\tshowMenuPaste,\n\tuseAllowGroup,\n\tuseAllowUngroup,\n\tuseThreeStackableItems,\n} from './menuHelpers'\nimport { useActions } from './useActions'\nimport { useHasLinkShapeSelected } from './useHasLinkShapeSelected'\nimport { useOnlyFlippableShape } from './useOnlyFlippableShape'\nimport { useShowAutoSizeToggle } from './useShowAutoSizeToggle'\n\n/** @public */\nexport type TLUiContextTTLUiMenuSchemaContextType = TLUiMenuSchema\n\n/** @internal */\nexport const TLUiContextMenuSchemaContext = React.createContext(\n\t{} as TLUiContextTTLUiMenuSchemaContextType\n)\n\n/** @public */\nexport type TLUiContextMenuSchemaProviderProps = {\n\toverrides?: (\n\t\teditor: Editor,\n\t\tschema: TLUiContextTTLUiMenuSchemaContextType,\n\t\thelpers: {\n\t\t\tactions: ReturnType<typeof useActions>\n\t\t\toneSelected: boolean\n\t\t\ttwoSelected: boolean\n\t\t\tthreeSelected: boolean\n\t\t\tshowAutoSizeToggle: boolean\n\t\t\tshowUngroup: boolean\n\t\t\tonlyFlippableShapeSelected: boolean\n\t\t}\n\t) => TLUiContextTTLUiMenuSchemaContextType\n\tchildren: any\n}\n\n/** @internal */\nexport const TLUiContextMenuSchemaProvider = track(function TLUiContextMenuSchemaProvider({\n\toverrides,\n\tchildren,\n}: TLUiContextMenuSchemaProviderProps) {\n\tconst editor = useEditor()\n\tconst actions = useActions()\n\n\tconst showAutoSizeToggle = useShowAutoSizeToggle()\n\n\tconst onlyFlippableShapeSelected = useOnlyFlippableShape()\n\n\tconst selectedCount = editor.getSelectedShapeIds().length\n\n\tconst oneSelected = selectedCount > 0\n\n\tconst twoSelected = selectedCount > 1\n\tconst threeSelected = selectedCount > 2\n\tconst threeStackableItems = useThreeStackableItems()\n\tconst atLeastOneShapeOnPage = useValue(\n\t\t'atLeastOneShapeOnPage',\n\t\t() => editor.currentPageShapeIds.size > 0,\n\t\t[]\n\t)\n\tconst isTransparentBg = useValue(\n\t\t'isTransparentBg',\n\t\t() => editor.getInstanceState().exportBackground,\n\t\t[]\n\t)\n\tconst allowGroup = useAllowGroup()\n\tconst allowUngroup = useAllowUngroup()\n\tconst hasClipboardWrite = Boolean(window.navigator.clipboard?.write)\n\tconst showEditLink = useHasLinkShapeSelected()\n\tconst onlySelectedShape = editor.getOnlySelectedShape()\n\tconst isShapeLocked = onlySelectedShape && editor.isShapeOrAncestorLocked(onlySelectedShape)\n\n\tconst contextTLUiMenuSchema = useMemo<TLUiMenuSchema>(() => {\n\t\tlet contextTLUiMenuSchema: TLUiContextTTLUiMenuSchemaContextType = compactMenuItems([\n\t\t\tmenuGroup(\n\t\t\t\t'selection',\n\t\t\t\tshowAutoSizeToggle && menuItem(actions['toggle-auto-size']),\n\t\t\t\tshowEditLink && !isShapeLocked && menuItem(actions['edit-link']),\n\t\t\t\toneSelected && !isShapeLocked && menuItem(actions['duplicate']),\n\t\t\t\tallowGroup && !isShapeLocked && menuItem(actions['group']),\n\t\t\t\tallowUngroup && !isShapeLocked && menuItem(actions['ungroup']),\n\t\t\t\toneSelected && menuItem(actions['toggle-lock'])\n\t\t\t),\n\t\t\tmenuGroup(\n\t\t\t\t'modify',\n\t\t\t\t(twoSelected || onlyFlippableShapeSelected) &&\n\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t'arrange',\n\t\t\t\t\t\t'context-menu.arrange',\n\t\t\t\t\t\ttwoSelected &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'align',\n\t\t\t\t\t\t\t\tmenuItem(actions['align-left']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-center-horizontal']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-right']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-top']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-center-vertical']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-bottom'])\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\tthreeSelected &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'distribute',\n\t\t\t\t\t\t\t\tmenuItem(actions['distribute-horizontal']),\n\t\t\t\t\t\t\t\tmenuItem(actions['distribute-vertical'])\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\ttwoSelected &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'stretch',\n\t\t\t\t\t\t\t\tmenuItem(actions['stretch-horizontal']),\n\t\t\t\t\t\t\t\tmenuItem(actions['stretch-vertical'])\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\tonlyFlippableShapeSelected &&\n\t\t\t\t\t\t\t!isShapeLocked &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'flip',\n\t\t\t\t\t\t\t\tmenuItem(actions['flip-horizontal']),\n\t\t\t\t\t\t\t\tmenuItem(actions['flip-vertical'])\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\ttwoSelected &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'order',\n\t\t\t\t\t\t\t\tmenuItem(actions['pack'], { disabled: !twoSelected }),\n\t\t\t\t\t\t\t\tthreeStackableItems && menuItem(actions['stack-vertical']),\n\t\t\t\t\t\t\t\tthreeStackableItems && menuItem(actions['stack-horizontal'])\n\t\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\toneSelected &&\n\t\t\t\t\t!isShapeLocked &&\n\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t'reorder',\n\t\t\t\t\t\t'context-menu.reorder',\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'reorder',\n\t\t\t\t\t\t\tmenuItem(actions['bring-to-front']),\n\t\t\t\t\t\t\tmenuItem(actions['bring-forward']),\n\t\t\t\t\t\t\tmenuItem(actions['send-backward']),\n\t\t\t\t\t\t\tmenuItem(actions['send-to-back'])\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\toneSelected && !isShapeLocked && menuCustom('MOVE_TO_PAGE_MENU', { readonlyOk: false })\n\t\t\t),\n\t\t\tmenuGroup(\n\t\t\t\t'clipboard-group',\n\t\t\t\toneSelected && !isShapeLocked && menuItem(actions['cut']),\n\t\t\t\toneSelected && menuItem(actions['copy']),\n\t\t\t\tshowMenuPaste && menuItem(actions['paste'])\n\t\t\t),\n\t\t\tatLeastOneShapeOnPage &&\n\t\t\t\tmenuGroup(\n\t\t\t\t\t'conversions',\n\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t'copy-as',\n\t\t\t\t\t\t'context-menu.copy-as',\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'copy-as-group',\n\t\t\t\t\t\t\tmenuItem(actions['copy-as-svg']),\n\t\t\t\t\t\t\thasClipboardWrite && menuItem(actions['copy-as-png']),\n\t\t\t\t\t\t\tmenuItem(actions['copy-as-json'])\n\t\t\t\t\t\t),\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'export-bg',\n\t\t\t\t\t\t\tmenuItem(actions['toggle-transparent'], { checked: !isTransparentBg })\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t'export-as',\n\t\t\t\t\t\t'context-menu.export-as',\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'export-as-group',\n\t\t\t\t\t\t\tmenuItem(actions['export-as-svg']),\n\t\t\t\t\t\t\tmenuItem(actions['export-as-png']),\n\t\t\t\t\t\t\tmenuItem(actions['export-as-json'])\n\t\t\t\t\t\t),\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'export-bg,',\n\t\t\t\t\t\t\tmenuItem(actions['toggle-transparent'], { checked: !isTransparentBg })\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t),\n\t\t\tatLeastOneShapeOnPage &&\n\t\t\t\tmenuGroup(\n\t\t\t\t\t'set-selection-group',\n\t\t\t\t\tmenuItem(actions['select-all']),\n\t\t\t\t\toneSelected && menuItem(actions['select-none'])\n\t\t\t\t),\n\t\t\toneSelected && !isShapeLocked && menuGroup('delete-group', menuItem(actions['delete'])),\n\t\t])\n\n\t\tif (overrides) {\n\t\t\tcontextTLUiMenuSchema = overrides(editor, contextTLUiMenuSchema, {\n\t\t\t\tactions,\n\t\t\t\toneSelected,\n\t\t\t\ttwoSelected,\n\t\t\t\tthreeSelected,\n\t\t\t\tshowAutoSizeToggle,\n\t\t\t\tshowUngroup: allowUngroup,\n\t\t\t\tonlyFlippableShapeSelected,\n\t\t\t})\n\t\t}\n\n\t\treturn contextTLUiMenuSchema\n\t}, [\n\t\teditor,\n\t\toverrides,\n\t\tactions,\n\t\toneSelected,\n\t\ttwoSelected,\n\t\tthreeSelected,\n\t\tshowAutoSizeToggle,\n\t\tonlyFlippableShapeSelected,\n\t\tatLeastOneShapeOnPage,\n\t\tthreeStackableItems,\n\t\tallowGroup,\n\t\tallowUngroup,\n\t\thasClipboardWrite,\n\t\tshowEditLink,\n\t\t// oneEmbedSelected,\n\t\t// oneEmbeddableBookmarkSelected,\n\t\tisTransparentBg,\n\t\tisShapeLocked,\n\t])\n\n\treturn (\n\t\t<TLUiContextMenuSchemaContext.Provider value={contextTLUiMenuSchema}>\n\t\t\t{children}\n\t\t</TLUiContextMenuSchemaContext.Provider>\n\t)\n})\n\n/** @public */\nexport function useContextMenuSchema(): TLUiMenuSchema {\n\tconst ctx = React.useContext(TLUiContextMenuSchemaContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.')\n\t}\n\n\treturn ctx\n}\n"],
  "mappings": "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",
  "names": ["TLUiContextMenuSchemaProvider", "contextTLUiMenuSchema"]
}
