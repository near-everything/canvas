(function(X,ke){typeof exports=="object"&&typeof module<"u"?ke(exports):typeof define=="function"&&define.amd?define(["exports"],ke):(X=typeof globalThis<"u"?globalThis:X||self,ke(X["@walletconnect/core"]={}))})(this,function(X){"use strict";var ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function At(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var ut={exports:{}},zt=typeof Reflect=="object"?Reflect:null,ci=zt&&typeof zt.apply=="function"?zt.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Or;zt&&typeof zt.ownKeys=="function"?Or=zt.ownKeys:Object.getOwnPropertySymbols?Or=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Or=function(e){return Object.getOwnPropertyNames(e)};function Ta(t){console&&console.warn&&console.warn(t)}var ui=Number.isNaN||function(e){return e!==e};function Se(){Se.init.call(this)}ut.exports=Se,ut.exports.once=Ca,Se.EventEmitter=Se,Se.prototype._events=void 0,Se.prototype._eventsCount=0,Se.prototype._maxListeners=void 0;var fi=10;function xr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Se,"defaultMaxListeners",{enumerable:!0,get:function(){return fi},set:function(t){if(typeof t!="number"||t<0||ui(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");fi=t}}),Se.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Se.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ui(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function hi(t){return t._maxListeners===void 0?Se.defaultMaxListeners:t._maxListeners}Se.prototype.getMaxListeners=function(){return hi(this)},Se.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var c;if(r.length>0&&(c=r[0]),c instanceof Error)throw c;var u=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw u.context=c,u}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")ci(h,this,r);else for(var f=h.length,l=yi(h,f),n=0;n<f;++n)ci(l[n],this,r);return!0};function li(t,e,r,n){var i,s,c;if(xr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),c=s[e]),c===void 0)c=s[e]=r,++t._eventsCount;else if(typeof c=="function"?c=s[e]=n?[r,c]:[c,r]:n?c.unshift(r):c.push(r),i=hi(t),i>0&&c.length>i&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=c.length,Ta(u)}return t}Se.prototype.addListener=function(e,r){return li(this,e,r,!1)},Se.prototype.on=Se.prototype.addListener,Se.prototype.prependListener=function(e,r){return li(this,e,r,!0)};function Ia(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function di(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Ia.bind(n);return i.listener=r,n.wrapFn=i,i}Se.prototype.once=function(e,r){return xr(r),this.on(e,di(this,e,r)),this},Se.prototype.prependOnceListener=function(e,r){return xr(r),this.prependListener(e,di(this,e,r)),this},Se.prototype.removeListener=function(e,r){var n,i,s,c,u;if(xr(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,c=n.length-1;c>=0;c--)if(n[c]===r||n[c].listener===r){u=n[c].listener,s=c;break}if(s<0)return this;s===0?n.shift():Ra(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,u||r)}return this},Se.prototype.off=Se.prototype.removeListener,Se.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),c;for(i=0;i<s.length;++i)c=s[i],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function _i(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Aa(i):yi(i,i.length)}Se.prototype.listeners=function(e){return _i(this,e,!0)},Se.prototype.rawListeners=function(e){return _i(this,e,!1)},Se.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):gi.call(t,e)},Se.prototype.listenerCount=gi;function gi(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Se.prototype.eventNames=function(){return this._eventsCount>0?Or(this._events):[]};function yi(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Ra(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Aa(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Ca(t,e){return new Promise(function(r,n){function i(c){t.removeListener(e,s),n(c)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}pi(t,e,s,{once:!0}),e!=="error"&&Pa(t,i,{once:!0})})}function Pa(t,e,r){typeof t.on=="function"&&pi(t,"error",e,r)}function pi(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}function La(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Na=Ua;function Ua(t,e,r){var n=r&&r.stringify||La,i=1;if(typeof t=="object"&&t!==null){var s=e.length+i;if(s===1)return t;var c=new Array(s);c[0]=n(t);for(var u=1;u<s;u++)c[u]=n(e[u]);return c.join(" ")}if(typeof t!="string")return t;var h=e.length;if(h===0)return t;for(var f="",l=1-i,w=-1,v=t&&t.length||0,b=0;b<v;){if(t.charCodeAt(b)===37&&b+1<v){switch(w=w>-1?w:0,t.charCodeAt(b+1)){case 100:case 102:if(l>=h||e[l]==null)break;w<b&&(f+=t.slice(w,b)),f+=Number(e[l]),w=b+2,b++;break;case 105:if(l>=h||e[l]==null)break;w<b&&(f+=t.slice(w,b)),f+=Math.floor(Number(e[l])),w=b+2,b++;break;case 79:case 111:case 106:if(l>=h||e[l]===void 0)break;w<b&&(f+=t.slice(w,b));var T=typeof e[l];if(T==="string"){f+="'"+e[l]+"'",w=b+2,b++;break}if(T==="function"){f+=e[l].name||"<anonymous>",w=b+2,b++;break}f+=n(e[l]),w=b+2,b++;break;case 115:if(l>=h)break;w<b&&(f+=t.slice(w,b)),f+=String(e[l]),w=b+2,b++;break;case 37:w<b&&(f+=t.slice(w,b)),f+="%",w=b+2,b++,l--;break}++l}++b}return w===-1?t:(w<v&&(f+=t.slice(w)),f)}const bi=Na;var tn=pt;const Jt=Va().console||{},Ma={mapHttpRequest:Ir,mapHttpResponse:Ir,wrapRequestSerializer:nn,wrapResponseSerializer:nn,wrapErrorSerializer:nn,req:Ir,res:Ir,err:za};function ja(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function pt(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||Jt;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=ja(t.browser.serialize,n);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const c=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const u=t.level||"info",h=Object.create(r);h.log||(h.log=Zt),Object.defineProperty(h,"levelVal",{get:l}),Object.defineProperty(h,"level",{get:w,set:v});const f={transmit:e,serialize:i,asObject:t.browser.asObject,levels:c,timestamp:Ha(t)};h.levels=pt.levels,h.level=u,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=Zt,h.serializers=n,h._serialize=i,h._stdErrSerialize=s,h.child=b,e&&(h._logEvent=rn());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function v(T){if(T!=="silent"&&!this.levels.values[T])throw Error("unknown level "+T);this._level=T,Ht(f,h,"error","log"),Ht(f,h,"fatal","error"),Ht(f,h,"warn","error"),Ht(f,h,"info","log"),Ht(f,h,"debug","log"),Ht(f,h,"trace","log")}function b(T,U){if(!T)throw new Error("missing bindings for child Pino");U=U||{},i&&T.serializers&&(U.serializers=T.serializers);const L=U.serializers;if(i&&L){var K=Object.assign({},n,L),S=t.browser.serialize===!0?Object.keys(K):i;delete T.serializers,Tr([T],S,K,this._stdErrSerialize)}function I(y){this._childLevel=(y._childLevel|0)+1,this.error=Kt(y,T,"error"),this.fatal=Kt(y,T,"fatal"),this.warn=Kt(y,T,"warn"),this.info=Kt(y,T,"info"),this.debug=Kt(y,T,"debug"),this.trace=Kt(y,T,"trace"),K&&(this.serializers=K,this._serialize=S),e&&(this._logEvent=rn([].concat(y._logEvent.bindings,T)))}return I.prototype=this,new I(this)}return h}pt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},pt.stdSerializers=Ma,pt.stdTimeFunctions=Object.assign({},{nullTime:vi,epochTime:Ei,unixTime:Ka,isoTime:Ga});function Ht(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Zt:i[r]?i[r]:Jt[r]||Jt[n]||Zt,$a(t,e,r)}function $a(t,e,r){!t.transmit&&e[r]===Zt||(e[r]=function(n){return function(){const s=t.timestamp(),c=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Jt?Jt:this;for(var h=0;h<c.length;h++)c[h]=arguments[h];if(t.serialize&&!t.asObject&&Tr(c,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(u,Fa(this,r,c,s)):n.apply(u,c),t.transmit){const f=t.transmit.level||e.level,l=pt.levels.values[f],w=pt.levels.values[r];if(w<l)return;Ba(this,{ts:s,methodLevel:r,methodValue:w,transmitLevel:f,transmitValue:pt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},c)}}}(e[r]))}function Fa(t,e,r,n){t._serialize&&Tr(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const c={};n&&(c.time=n),c.level=pt.levels.values[e];let u=(t._childLevel|0)+1;if(u<1&&(u=1),s!==null&&typeof s=="object"){for(;u--&&typeof i[0]=="object";)Object.assign(c,i.shift());s=i.length?bi(i.shift(),i):void 0}else typeof s=="string"&&(s=bi(i.shift(),i));return s!==void 0&&(c.msg=s),c}function Tr(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=pt.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const s in t[i])e&&e.indexOf(s)>-1&&s in r&&(t[i][s]=r[s](t[i][s]))}function Kt(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function Ba(t,e,r){const n=e.send,i=e.ts,s=e.methodLevel,c=e.methodValue,u=e.val,h=t._logEvent.bindings;Tr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(f){return h.indexOf(f)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=c,n(s,t._logEvent,u),t._logEvent=rn(h)}function rn(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function za(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Ha(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?vi:Ei}function Ir(){return{}}function nn(t){return t}function Zt(){}function vi(){return!1}function Ei(){return Date.now()}function Ka(){return Math.round(Date.now()/1e3)}function Ga(){return new Date(Date.now()).toISOString()}function Va(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var Rr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var sn=function(t,e){return sn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},sn(t,e)};function qa(t,e){sn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var on=function(){return on=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},on.apply(this,arguments)};function Wa(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Ya(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Xa(t,e){return function(r,n){e(r,n,t)}}function ka(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ja(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(l){try{f(n.next(l))}catch(w){c(w)}}function h(l){try{f(n.throw(l))}catch(w){c(w)}}function f(l){l.done?s(l.value):i(l.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function Za(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Qa(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function ec(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function an(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wi(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function tc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(wi(arguments[e]));return t}function rc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function Qt(t){return this instanceof Qt?(this.v=t,this):new Qt(t)}function nc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof Qt?Promise.resolve(v.value.v).then(f,l):w(s[0][2],v)}function f(v){u("next",v)}function l(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function ic(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:Qt(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function sc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof an=="function"?an(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function oc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ac(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function cc(t){return t&&t.__esModule?t:{default:t}}function uc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function fc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var hc=Object.freeze({__proto__:null,__extends:qa,get __assign(){return on},__rest:Wa,__decorate:Ya,__param:Xa,__metadata:ka,__awaiter:Ja,__generator:Za,__createBinding:Qa,__exportStar:ec,__values:an,__read:wi,__spread:tc,__spreadArrays:rc,__await:Qt,__asyncGenerator:nc,__asyncDelegator:ic,__asyncValues:sc,__makeTemplateObject:oc,__importStar:ac,__importDefault:cc,__classPrivateFieldGet:uc,__classPrivateFieldSet:fc}),mi=At(hc),er={};Object.defineProperty(er,"__esModule",{value:!0});function lc(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}er.safeJsonParse=lc;function dc(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}er.safeJsonStringify=dc;var tr={exports:{}},Di;function _c(){return Di||(Di=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ke<"u"&&ke.localStorage?tr.exports=ke.localStorage:typeof window<"u"&&window.localStorage?tr.exports=window.localStorage:tr.exports=new e}()),tr.exports}var cn={},rr={},Si;function gc(){if(Si)return rr;Si=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.IKeyValueStorage=void 0;class t{}return rr.IKeyValueStorage=t,rr}var nr={},Oi;function yc(){if(Oi)return nr;Oi=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.parseEntry=void 0;const t=er;function e(r){var n;return[r[0],t.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return nr.parseEntry=e,nr}var xi;function pc(){return xi||(xi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=mi;e.__exportStar(gc(),t),e.__exportStar(yc(),t)}(cn)),cn}Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.KeyValueStorage=void 0;const Gt=mi,Ti=er,bc=Gt.__importDefault(_c()),vc=pc();class Ii{constructor(){this.localStorage=bc.default}getKeys(){return Gt.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Gt.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(vc.parseEntry)})}getItem(e){return Gt.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return Ti.safeJsonParse(r)})}setItem(e,r){return Gt.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Ti.safeJsonStringify(r))})}removeItem(e){return Gt.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Rr.KeyValueStorage=Ii;var Ec=Rr.default=Ii,ir={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var un=function(t,e){return un=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},un(t,e)};function wc(t,e){un(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var fn=function(){return fn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},fn.apply(this,arguments)};function mc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Dc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Sc(t,e){return function(r,n){e(r,n,t)}}function Oc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function xc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(l){try{f(n.next(l))}catch(w){c(w)}}function h(l){try{f(n.throw(l))}catch(w){c(w)}}function f(l){l.done?s(l.value):i(l.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function Tc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Ic(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Rc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function hn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ri(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function Ac(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ri(arguments[e]));return t}function Cc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function sr(t){return this instanceof sr?(this.v=t,this):new sr(t)}function Pc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof sr?Promise.resolve(v.value.v).then(f,l):w(s[0][2],v)}function f(v){u("next",v)}function l(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Lc(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:sr(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function Nc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof hn=="function"?hn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function Uc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Mc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function jc(t){return t&&t.__esModule?t:{default:t}}function $c(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Fc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Bc=Object.freeze({__proto__:null,__extends:wc,get __assign(){return fn},__rest:mc,__decorate:Dc,__param:Sc,__metadata:Oc,__awaiter:xc,__generator:Tc,__createBinding:Ic,__exportStar:Rc,__values:hn,__read:Ri,__spread:Ac,__spreadArrays:Cc,__await:sr,__asyncGenerator:Pc,__asyncDelegator:Lc,__asyncValues:Nc,__makeTemplateObject:Uc,__importStar:Mc,__importDefault:jc,__classPrivateFieldGet:$c,__classPrivateFieldSet:Fc}),Ar=At(Bc),or={},De={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ln=function(t,e){return ln=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ln(t,e)};function zc(t,e){ln(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var dn=function(){return dn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},dn.apply(this,arguments)};function Hc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Kc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Gc(t,e){return function(r,n){e(r,n,t)}}function Vc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function qc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(l){try{f(n.next(l))}catch(w){c(w)}}function h(l){try{f(n.throw(l))}catch(w){c(w)}}function f(l){l.done?s(l.value):i(l.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function Wc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Yc(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Xc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function _n(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ai(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function kc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ai(arguments[e]));return t}function Jc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function ar(t){return this instanceof ar?(this.v=t,this):new ar(t)}function Zc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof ar?Promise.resolve(v.value.v).then(f,l):w(s[0][2],v)}function f(v){u("next",v)}function l(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Qc(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:ar(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function eu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof _n=="function"?_n(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function tu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ru(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function nu(t){return t&&t.__esModule?t:{default:t}}function iu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function su(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var ou=Object.freeze({__proto__:null,__extends:zc,get __assign(){return dn},__rest:Hc,__decorate:Kc,__param:Gc,__metadata:Vc,__awaiter:qc,__generator:Wc,__createBinding:Yc,__exportStar:Xc,__values:_n,__read:Ai,__spread:kc,__spreadArrays:Jc,__await:ar,__asyncGenerator:Zc,__asyncDelegator:Qc,__asyncValues:eu,__makeTemplateObject:tu,__importStar:ru,__importDefault:nu,__classPrivateFieldGet:iu,__classPrivateFieldSet:su}),Cr=At(ou),gn={},cr={},Ci;function au(){if(Ci)return cr;Ci=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return cr.delay=t,cr}var Ct={},yn={},Pt={},Pi;function cu(){return Pi||(Pi=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.ONE_THOUSAND=Pt.ONE_HUNDRED=void 0,Pt.ONE_HUNDRED=100,Pt.ONE_THOUSAND=1e3),Pt}var pn={},Li;function uu(){return Li||(Li=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(pn)),pn}var Ni;function Ui(){return Ni||(Ni=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cr;e.__exportStar(cu(),t),e.__exportStar(uu(),t)}(yn)),yn}var Mi;function fu(){if(Mi)return Ct;Mi=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.fromMiliseconds=Ct.toMiliseconds=void 0;const t=Ui();function e(n){return n*t.ONE_THOUSAND}Ct.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Ct.fromMiliseconds=r,Ct}var ji;function hu(){return ji||(ji=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cr;e.__exportStar(au(),t),e.__exportStar(fu(),t)}(gn)),gn}var Vt={},$i;function lu(){if($i)return Vt;$i=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Vt.Watch=t,Vt.default=t,Vt}var bn={},ur={},Fi;function du(){if(Fi)return ur;Fi=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.IWatch=void 0;class t{}return ur.IWatch=t,ur}var Bi;function _u(){return Bi||(Bi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Cr.__exportStar(du(),t)}(bn)),bn}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cr;e.__exportStar(hu(),t),e.__exportStar(lu(),t),e.__exportStar(_u(),t),e.__exportStar(Ui(),t)})(De);var vn={},fr={};class Lt{}var gu=Object.freeze({__proto__:null,IEvents:Lt}),yu=At(gu),zi;function pu(){if(zi)return fr;zi=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.IHeartBeat=void 0;const t=yu;class e extends t.IEvents{constructor(n){super()}}return fr.IHeartBeat=e,fr}var Hi;function Ki(){return Hi||(Hi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Ar.__exportStar(pu(),t)}(vn)),vn}var En={},Nt={},Gi;function bu(){if(Gi)return Nt;Gi=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.HEARTBEAT_EVENTS=Nt.HEARTBEAT_INTERVAL=void 0;const t=De;return Nt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Nt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Nt}var Vi;function qi(){return Vi||(Vi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Ar.__exportStar(bu(),t)}(En)),En}var Wi;function vu(){if(Wi)return or;Wi=1,Object.defineProperty(or,"__esModule",{value:!0}),or.HeartBeat=void 0;const t=Ar,e=ut.exports,r=De,n=Ki(),i=qi();class s extends n.IHeartBeat{constructor(u){super(u),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=u?.interval||i.HEARTBEAT_INTERVAL}static init(u){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(u);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,h){this.events.on(u,h)}once(u,h){this.events.once(u,h)}off(u,h){this.events.off(u,h)}removeListener(u,h){this.events.removeListener(u,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return or.HeartBeat=s,or}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ar;e.__exportStar(vu(),t),e.__exportStar(Ki(),t),e.__exportStar(qi(),t)})(ir);var Te={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var wn=function(t,e){return wn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},wn(t,e)};function Eu(t,e){wn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var mn=function(){return mn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},mn.apply(this,arguments)};function wu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function mu(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Du(t,e){return function(r,n){e(r,n,t)}}function Su(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ou(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(l){try{f(n.next(l))}catch(w){c(w)}}function h(l){try{f(n.throw(l))}catch(w){c(w)}}function f(l){l.done?s(l.value):i(l.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function xu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Tu(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Iu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Dn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yi(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function Ru(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Yi(arguments[e]));return t}function Au(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function hr(t){return this instanceof hr?(this.v=t,this):new hr(t)}function Cu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof hr?Promise.resolve(v.value.v).then(f,l):w(s[0][2],v)}function f(v){u("next",v)}function l(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Pu(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:hr(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function Lu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Dn=="function"?Dn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function Nu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Uu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Mu(t){return t&&t.__esModule?t:{default:t}}function ju(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function $u(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Fu=Object.freeze({__proto__:null,__extends:Eu,get __assign(){return mn},__rest:wu,__decorate:mu,__param:Du,__metadata:Su,__awaiter:Ou,__generator:xu,__createBinding:Tu,__exportStar:Iu,__values:Dn,__read:Yi,__spread:Ru,__spreadArrays:Au,__await:hr,__asyncGenerator:Cu,__asyncDelegator:Pu,__asyncValues:Lu,__makeTemplateObject:Nu,__importStar:Uu,__importDefault:Mu,__classPrivateFieldGet:ju,__classPrivateFieldSet:$u}),Bu=At(Fu),Ut={},Xi;function ki(){return Xi||(Xi=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.PINO_CUSTOM_CONTEXT_KEY=Ut.PINO_LOGGER_DEFAULTS=void 0,Ut.PINO_LOGGER_DEFAULTS={level:"info"},Ut.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ut}var rt={},Ji;function zu(){if(Ji)return rt;Ji=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.generateChildLogger=rt.formatChildLoggerContext=rt.getLoggerContext=rt.setBrowserLoggerContext=rt.getBrowserLoggerContext=rt.getDefaultLoggerOptions=void 0;const t=ki();function e(u){return Object.assign(Object.assign({},u),{level:u?.level||t.PINO_LOGGER_DEFAULTS.level})}rt.getDefaultLoggerOptions=e;function r(u,h=t.PINO_CUSTOM_CONTEXT_KEY){return u[h]||""}rt.getBrowserLoggerContext=r;function n(u,h,f=t.PINO_CUSTOM_CONTEXT_KEY){return u[f]=h,u}rt.setBrowserLoggerContext=n;function i(u,h=t.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof u.bindings>"u"?f=r(u,h):f=u.bindings().context||"",f}rt.getLoggerContext=i;function s(u,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const l=i(u,f);return l.trim()?`${l}/${h}`:h}rt.formatChildLoggerContext=s;function c(u,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const l=s(u,h,f),w=u.child({context:l});return n(w,l,f)}return rt.generateChildLogger=c,rt}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Bu,r=e.__importDefault(tn);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(ki(),t),e.__exportStar(zu(),t)})(Te);class Hu extends Lt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Ku extends Lt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Gu{constructor(e,r){this.logger=e,this.core=r}}class Vu extends Lt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class qu extends Lt{constructor(e){super()}}class Wu{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class Yu extends Lt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Xu extends Lt{constructor(e,r){super(),this.core=e,this.logger=r}}function Zi(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function Sn(t){return typeof t=="string"?t:JSON.stringify(t)}var On={},qt={},Pr={},Lr={};Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.BrowserRandomSource=void 0;const Qi=65536;class ku{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=Qi)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Qi)));return r}}Lr.BrowserRandomSource=ku;function Ju(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Nr={},ot={};Object.defineProperty(ot,"__esModule",{value:!0});function Zu(t){for(var e=0;e<t.length;e++)t[e]=0;return t}ot.wipe=Zu;var Qu={},ef=Object.freeze({__proto__:null,default:Qu}),tf=At(ef);Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.NodeRandomSource=void 0;const rf=ot;class nf{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Ju<"u"){const e=tf;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,rf.wipe)(r),n}}Nr.NodeRandomSource=nf,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.SystemRandomSource=void 0;const sf=Lr,of=Nr;class af{constructor(){if(this.isAvailable=!1,this.name="",this._source=new sf.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new of.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Pr.SystemRandomSource=af;var ee={},es={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(u,h){var f=u>>>16&65535,l=u&65535,w=h>>>16&65535,v=h&65535;return l*v+(f*v+l*w<<16>>>0)|0}t.mul=Math.imul||e;function r(u,h){return u+h|0}t.add=r;function n(u,h){return u-h|0}t.sub=n;function i(u,h){return u<<h|u>>>32-h}t.rotl=i;function s(u,h){return u<<32-h|u>>>h}t.rotr=s;function c(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}t.isInteger=Number.isInteger||c,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(u){return t.isInteger(u)&&u>=-t.MAX_SAFE_INTEGER&&u<=t.MAX_SAFE_INTEGER}})(es),Object.defineProperty(ee,"__esModule",{value:!0});var ts=es;function cf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ee.readInt16BE=cf;function uf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ee.readUint16BE=uf;function ff(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ee.readInt16LE=ff;function hf(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ee.readUint16LE=hf;function rs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ee.writeUint16BE=rs,ee.writeInt16BE=rs;function ns(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ee.writeUint16LE=ns,ee.writeInt16LE=ns;function xn(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ee.readInt32BE=xn;function Tn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ee.readUint32BE=Tn;function In(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ee.readInt32LE=In;function Rn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ee.readUint32LE=Rn;function Ur(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ee.writeUint32BE=Ur,ee.writeInt32BE=Ur;function Mr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ee.writeUint32LE=Mr,ee.writeInt32LE=Mr;function lf(t,e){e===void 0&&(e=0);var r=xn(t,e),n=xn(t,e+4);return r*4294967296+n-(n>>31)*4294967296}ee.readInt64BE=lf;function df(t,e){e===void 0&&(e=0);var r=Tn(t,e),n=Tn(t,e+4);return r*4294967296+n}ee.readUint64BE=df;function _f(t,e){e===void 0&&(e=0);var r=In(t,e),n=In(t,e+4);return n*4294967296+r-(r>>31)*4294967296}ee.readInt64LE=_f;function gf(t,e){e===void 0&&(e=0);var r=Rn(t,e),n=Rn(t,e+4);return n*4294967296+r}ee.readUint64LE=gf;function is(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ur(t/4294967296>>>0,e,r),Ur(t>>>0,e,r+4),e}ee.writeUint64BE=is,ee.writeInt64BE=is;function ss(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Mr(t>>>0,e,r),Mr(t/4294967296>>>0,e,r+4),e}ee.writeUint64LE=ss,ee.writeInt64LE=ss;function yf(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}ee.readUintBE=yf;function pf(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}ee.readUintLE=pf;function bf(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ts.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}ee.writeUintBE=bf;function vf(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ts.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}ee.writeUintLE=vf;function Ef(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ee.readFloat32BE=Ef;function wf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ee.readFloat32LE=wf;function mf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ee.readFloat64BE=mf;function Df(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ee.readFloat64LE=Df;function Sf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}ee.writeFloat32BE=Sf;function Of(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}ee.writeFloat32LE=Of;function xf(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}ee.writeFloat64BE=xf;function Tf(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}ee.writeFloat64LE=Tf,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Pr,r=ee,n=ot;t.defaultRandomSource=new e.SystemRandomSource;function i(f,l=t.defaultRandomSource){return l.randomBytes(f)}t.randomBytes=i;function s(f=t.defaultRandomSource){const l=i(4,f),w=(0,r.readUint32LE)(l);return(0,n.wipe)(l),w}t.randomUint32=s;const c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(f,l=c,w=t.defaultRandomSource){if(l.length<2)throw new Error("randomString charset is too short");if(l.length>256)throw new Error("randomString charset is too long");let v="";const b=l.length,T=256-256%b;for(;f>0;){const U=i(Math.ceil(f*256/T),w);for(let L=0;L<U.length&&f>0;L++){const K=U[L];K<T&&(v+=l.charAt(K%b),f--)}(0,n.wipe)(U)}return v}t.randomString=u;function h(f,l=c,w=t.defaultRandomSource){const v=Math.ceil(f/(Math.log(l.length)/Math.LN2));return u(v,l,w)}t.randomStringForEntropy=h}(qt);var os={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ee,r=ot;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},u.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,w=f/536870912|0,v=f<<3,b=f%128<112?128:256;this._buffer[l]=128;for(var T=l+1;T<b-8;T++)this._buffer[T]=0;e.writeUint32BE(w,this._buffer,b-8),e.writeUint32BE(v,this._buffer,b-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,b),this._finished=!0}for(var T=0;T<this.digestLength/8;T++)e.writeUint32BE(this._stateHi[T],h,T*8),e.writeUint32BE(this._stateLo[T],h,T*8+4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(u,h,f,l,w,v,b){for(var T=f[0],U=f[1],L=f[2],K=f[3],S=f[4],I=f[5],y=f[6],E=f[7],p=l[0],o=l[1],_=l[2],j=l[3],F=l[4],Y=l[5],k=l[6],J=l[7],A,R,q,$,P,N,M,B;b>=128;){for(var re=0;re<16;re++){var z=8*re+v;u[re]=e.readUint32BE(w,z),h[re]=e.readUint32BE(w,z+4)}for(var re=0;re<80;re++){var Z=T,W=U,oe=L,x=K,O=S,m=I,a=y,g=E,H=p,G=o,fe=_,ye=j,le=F,ve=Y,Ue=k,Ce=J;if(A=E,R=J,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=(S>>>14|F<<32-14)^(S>>>18|F<<32-18)^(F>>>41-32|S<<32-(41-32)),R=(F>>>14|S<<32-14)^(F>>>18|S<<32-18)^(S>>>41-32|F<<32-(41-32)),P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,A=S&I^~S&y,R=F&Y^~F&k,P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,A=i[re*2],R=i[re*2+1],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,A=u[re%16],R=h[re%16],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,q=M&65535|B<<16,$=P&65535|N<<16,A=q,R=$,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=(T>>>28|p<<32-28)^(p>>>34-32|T<<32-(34-32))^(p>>>39-32|T<<32-(39-32)),R=(p>>>28|T<<32-28)^(T>>>34-32|p<<32-(34-32))^(T>>>39-32|p<<32-(39-32)),P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,A=T&U^T&L^U&L,R=p&o^p&_^o&_,P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,g=M&65535|B<<16,Ce=P&65535|N<<16,A=x,R=ye,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=q,R=$,P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,x=M&65535|B<<16,ye=P&65535|N<<16,U=Z,L=W,K=oe,S=x,I=O,y=m,E=a,T=g,o=H,_=G,j=fe,F=ye,Y=le,k=ve,J=Ue,p=Ce,re%16===15)for(var z=0;z<16;z++)A=u[z],R=h[z],P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=u[(z+9)%16],R=h[(z+9)%16],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,q=u[(z+1)%16],$=h[(z+1)%16],A=(q>>>1|$<<32-1)^(q>>>8|$<<32-8)^q>>>7,R=($>>>1|q<<32-1)^($>>>8|q<<32-8)^($>>>7|q<<32-7),P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,q=u[(z+14)%16],$=h[(z+14)%16],A=(q>>>19|$<<32-19)^($>>>61-32|q<<32-(61-32))^q>>>6,R=($>>>19|q<<32-19)^(q>>>61-32|$<<32-(61-32))^($>>>6|q<<32-6),P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,u[z]=M&65535|B<<16,h[z]=P&65535|N<<16}A=T,R=p,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[0],R=l[0],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[0]=T=M&65535|B<<16,l[0]=p=P&65535|N<<16,A=U,R=o,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[1],R=l[1],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[1]=U=M&65535|B<<16,l[1]=o=P&65535|N<<16,A=L,R=_,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[2],R=l[2],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[2]=L=M&65535|B<<16,l[2]=_=P&65535|N<<16,A=K,R=j,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[3],R=l[3],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[3]=K=M&65535|B<<16,l[3]=j=P&65535|N<<16,A=S,R=F,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[4],R=l[4],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[4]=S=M&65535|B<<16,l[4]=F=P&65535|N<<16,A=I,R=Y,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[5],R=l[5],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[5]=I=M&65535|B<<16,l[5]=Y=P&65535|N<<16,A=y,R=k,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[6],R=l[6],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[6]=y=M&65535|B<<16,l[6]=k=P&65535|N<<16,A=E,R=J,P=R&65535,N=R>>>16,M=A&65535,B=A>>>16,A=f[7],R=l[7],P+=R&65535,N+=R>>>16,M+=A&65535,B+=A>>>16,N+=P>>>16,M+=N>>>16,B+=M>>>16,f[7]=E=M&65535|B<<16,l[7]=J=P&65535|N<<16,v+=128,b-=128}return v}function c(u){var h=new n;h.update(u);var f=h.digest();return h.clean(),f}t.hash=c})(os),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=qt,r=os,n=ot;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(x){const O=new Float64Array(16);if(x)for(let m=0;m<x.length;m++)O[m]=x[m];return O}const s=new Uint8Array(32);s[0]=9;const c=i(),u=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),v=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(x,O){for(let m=0;m<16;m++)x[m]=O[m]|0}function T(x){let O=1;for(let m=0;m<16;m++){let a=x[m]+O+65535;O=Math.floor(a/65536),x[m]=a-O*65536}x[0]+=O-1+37*(O-1)}function U(x,O,m){const a=~(m-1);for(let g=0;g<16;g++){const H=a&(x[g]^O[g]);x[g]^=H,O[g]^=H}}function L(x,O){const m=i(),a=i();for(let g=0;g<16;g++)a[g]=O[g];T(a),T(a),T(a);for(let g=0;g<2;g++){m[0]=a[0]-65517;for(let G=1;G<15;G++)m[G]=a[G]-65535-(m[G-1]>>16&1),m[G-1]&=65535;m[15]=a[15]-32767-(m[14]>>16&1);const H=m[15]>>16&1;m[14]&=65535,U(a,m,1-H)}for(let g=0;g<16;g++)x[2*g]=a[g]&255,x[2*g+1]=a[g]>>8}function K(x,O){let m=0;for(let a=0;a<32;a++)m|=x[a]^O[a];return(1&m-1>>>8)-1}function S(x,O){const m=new Uint8Array(32),a=new Uint8Array(32);return L(m,x),L(a,O),K(m,a)}function I(x){const O=new Uint8Array(32);return L(O,x),O[0]&1}function y(x,O){for(let m=0;m<16;m++)x[m]=O[2*m]+(O[2*m+1]<<8);x[15]&=32767}function E(x,O,m){for(let a=0;a<16;a++)x[a]=O[a]+m[a]}function p(x,O,m){for(let a=0;a<16;a++)x[a]=O[a]-m[a]}function o(x,O,m){let a,g,H=0,G=0,fe=0,ye=0,le=0,ve=0,Ue=0,Ce=0,ge=0,de=0,he=0,ce=0,ae=0,se=0,ie=0,Q=0,ue=0,_e=0,te=0,pe=0,be=0,we=0,me=0,Ee=0,gt=0,vt=0,xt=0,at=0,jt=0,mr=0,Yr=0,Me=m[0],Pe=m[1],je=m[2],$e=m[3],Fe=m[4],Le=m[5],He=m[6],Ke=m[7],Ge=m[8],Ve=m[9],qe=m[10],ze=m[11],Be=m[12],Re=m[13],We=m[14],Ye=m[15];a=O[0],H+=a*Me,G+=a*Pe,fe+=a*je,ye+=a*$e,le+=a*Fe,ve+=a*Le,Ue+=a*He,Ce+=a*Ke,ge+=a*Ge,de+=a*Ve,he+=a*qe,ce+=a*ze,ae+=a*Be,se+=a*Re,ie+=a*We,Q+=a*Ye,a=O[1],G+=a*Me,fe+=a*Pe,ye+=a*je,le+=a*$e,ve+=a*Fe,Ue+=a*Le,Ce+=a*He,ge+=a*Ke,de+=a*Ge,he+=a*Ve,ce+=a*qe,ae+=a*ze,se+=a*Be,ie+=a*Re,Q+=a*We,ue+=a*Ye,a=O[2],fe+=a*Me,ye+=a*Pe,le+=a*je,ve+=a*$e,Ue+=a*Fe,Ce+=a*Le,ge+=a*He,de+=a*Ke,he+=a*Ge,ce+=a*Ve,ae+=a*qe,se+=a*ze,ie+=a*Be,Q+=a*Re,ue+=a*We,_e+=a*Ye,a=O[3],ye+=a*Me,le+=a*Pe,ve+=a*je,Ue+=a*$e,Ce+=a*Fe,ge+=a*Le,de+=a*He,he+=a*Ke,ce+=a*Ge,ae+=a*Ve,se+=a*qe,ie+=a*ze,Q+=a*Be,ue+=a*Re,_e+=a*We,te+=a*Ye,a=O[4],le+=a*Me,ve+=a*Pe,Ue+=a*je,Ce+=a*$e,ge+=a*Fe,de+=a*Le,he+=a*He,ce+=a*Ke,ae+=a*Ge,se+=a*Ve,ie+=a*qe,Q+=a*ze,ue+=a*Be,_e+=a*Re,te+=a*We,pe+=a*Ye,a=O[5],ve+=a*Me,Ue+=a*Pe,Ce+=a*je,ge+=a*$e,de+=a*Fe,he+=a*Le,ce+=a*He,ae+=a*Ke,se+=a*Ge,ie+=a*Ve,Q+=a*qe,ue+=a*ze,_e+=a*Be,te+=a*Re,pe+=a*We,be+=a*Ye,a=O[6],Ue+=a*Me,Ce+=a*Pe,ge+=a*je,de+=a*$e,he+=a*Fe,ce+=a*Le,ae+=a*He,se+=a*Ke,ie+=a*Ge,Q+=a*Ve,ue+=a*qe,_e+=a*ze,te+=a*Be,pe+=a*Re,be+=a*We,we+=a*Ye,a=O[7],Ce+=a*Me,ge+=a*Pe,de+=a*je,he+=a*$e,ce+=a*Fe,ae+=a*Le,se+=a*He,ie+=a*Ke,Q+=a*Ge,ue+=a*Ve,_e+=a*qe,te+=a*ze,pe+=a*Be,be+=a*Re,we+=a*We,me+=a*Ye,a=O[8],ge+=a*Me,de+=a*Pe,he+=a*je,ce+=a*$e,ae+=a*Fe,se+=a*Le,ie+=a*He,Q+=a*Ke,ue+=a*Ge,_e+=a*Ve,te+=a*qe,pe+=a*ze,be+=a*Be,we+=a*Re,me+=a*We,Ee+=a*Ye,a=O[9],de+=a*Me,he+=a*Pe,ce+=a*je,ae+=a*$e,se+=a*Fe,ie+=a*Le,Q+=a*He,ue+=a*Ke,_e+=a*Ge,te+=a*Ve,pe+=a*qe,be+=a*ze,we+=a*Be,me+=a*Re,Ee+=a*We,gt+=a*Ye,a=O[10],he+=a*Me,ce+=a*Pe,ae+=a*je,se+=a*$e,ie+=a*Fe,Q+=a*Le,ue+=a*He,_e+=a*Ke,te+=a*Ge,pe+=a*Ve,be+=a*qe,we+=a*ze,me+=a*Be,Ee+=a*Re,gt+=a*We,vt+=a*Ye,a=O[11],ce+=a*Me,ae+=a*Pe,se+=a*je,ie+=a*$e,Q+=a*Fe,ue+=a*Le,_e+=a*He,te+=a*Ke,pe+=a*Ge,be+=a*Ve,we+=a*qe,me+=a*ze,Ee+=a*Be,gt+=a*Re,vt+=a*We,xt+=a*Ye,a=O[12],ae+=a*Me,se+=a*Pe,ie+=a*je,Q+=a*$e,ue+=a*Fe,_e+=a*Le,te+=a*He,pe+=a*Ke,be+=a*Ge,we+=a*Ve,me+=a*qe,Ee+=a*ze,gt+=a*Be,vt+=a*Re,xt+=a*We,at+=a*Ye,a=O[13],se+=a*Me,ie+=a*Pe,Q+=a*je,ue+=a*$e,_e+=a*Fe,te+=a*Le,pe+=a*He,be+=a*Ke,we+=a*Ge,me+=a*Ve,Ee+=a*qe,gt+=a*ze,vt+=a*Be,xt+=a*Re,at+=a*We,jt+=a*Ye,a=O[14],ie+=a*Me,Q+=a*Pe,ue+=a*je,_e+=a*$e,te+=a*Fe,pe+=a*Le,be+=a*He,we+=a*Ke,me+=a*Ge,Ee+=a*Ve,gt+=a*qe,vt+=a*ze,xt+=a*Be,at+=a*Re,jt+=a*We,mr+=a*Ye,a=O[15],Q+=a*Me,ue+=a*Pe,_e+=a*je,te+=a*$e,pe+=a*Fe,be+=a*Le,we+=a*He,me+=a*Ke,Ee+=a*Ge,gt+=a*Ve,vt+=a*qe,xt+=a*ze,at+=a*Be,jt+=a*Re,mr+=a*We,Yr+=a*Ye,H+=38*ue,G+=38*_e,fe+=38*te,ye+=38*pe,le+=38*be,ve+=38*we,Ue+=38*me,Ce+=38*Ee,ge+=38*gt,de+=38*vt,he+=38*xt,ce+=38*at,ae+=38*jt,se+=38*mr,ie+=38*Yr,g=1,a=H+g+65535,g=Math.floor(a/65536),H=a-g*65536,a=G+g+65535,g=Math.floor(a/65536),G=a-g*65536,a=fe+g+65535,g=Math.floor(a/65536),fe=a-g*65536,a=ye+g+65535,g=Math.floor(a/65536),ye=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=ve+g+65535,g=Math.floor(a/65536),ve=a-g*65536,a=Ue+g+65535,g=Math.floor(a/65536),Ue=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=ge+g+65535,g=Math.floor(a/65536),ge=a-g*65536,a=de+g+65535,g=Math.floor(a/65536),de=a-g*65536,a=he+g+65535,g=Math.floor(a/65536),he=a-g*65536,a=ce+g+65535,g=Math.floor(a/65536),ce=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,a=se+g+65535,g=Math.floor(a/65536),se=a-g*65536,a=ie+g+65535,g=Math.floor(a/65536),ie=a-g*65536,a=Q+g+65535,g=Math.floor(a/65536),Q=a-g*65536,H+=g-1+37*(g-1),g=1,a=H+g+65535,g=Math.floor(a/65536),H=a-g*65536,a=G+g+65535,g=Math.floor(a/65536),G=a-g*65536,a=fe+g+65535,g=Math.floor(a/65536),fe=a-g*65536,a=ye+g+65535,g=Math.floor(a/65536),ye=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=ve+g+65535,g=Math.floor(a/65536),ve=a-g*65536,a=Ue+g+65535,g=Math.floor(a/65536),Ue=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=ge+g+65535,g=Math.floor(a/65536),ge=a-g*65536,a=de+g+65535,g=Math.floor(a/65536),de=a-g*65536,a=he+g+65535,g=Math.floor(a/65536),he=a-g*65536,a=ce+g+65535,g=Math.floor(a/65536),ce=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,a=se+g+65535,g=Math.floor(a/65536),se=a-g*65536,a=ie+g+65535,g=Math.floor(a/65536),ie=a-g*65536,a=Q+g+65535,g=Math.floor(a/65536),Q=a-g*65536,H+=g-1+37*(g-1),x[0]=H,x[1]=G,x[2]=fe,x[3]=ye,x[4]=le,x[5]=ve,x[6]=Ue,x[7]=Ce,x[8]=ge,x[9]=de,x[10]=he,x[11]=ce,x[12]=ae,x[13]=se,x[14]=ie,x[15]=Q}function _(x,O){o(x,O,O)}function j(x,O){const m=i();let a;for(a=0;a<16;a++)m[a]=O[a];for(a=253;a>=0;a--)_(m,m),a!==2&&a!==4&&o(m,m,O);for(a=0;a<16;a++)x[a]=m[a]}function F(x,O){const m=i();let a;for(a=0;a<16;a++)m[a]=O[a];for(a=250;a>=0;a--)_(m,m),a!==1&&o(m,m,O);for(a=0;a<16;a++)x[a]=m[a]}function Y(x,O){const m=i(),a=i(),g=i(),H=i(),G=i(),fe=i(),ye=i(),le=i(),ve=i();p(m,x[1],x[0]),p(ve,O[1],O[0]),o(m,m,ve),E(a,x[0],x[1]),E(ve,O[0],O[1]),o(a,a,ve),o(g,x[3],O[3]),o(g,g,f),o(H,x[2],O[2]),E(H,H,H),p(G,a,m),p(fe,H,g),E(ye,H,g),E(le,a,m),o(x[0],G,fe),o(x[1],le,ye),o(x[2],ye,fe),o(x[3],G,le)}function k(x,O,m){for(let a=0;a<4;a++)U(x[a],O[a],m)}function J(x,O){const m=i(),a=i(),g=i();j(g,O[2]),o(m,O[0],g),o(a,O[1],g),L(x,a),x[31]^=I(m)<<7}function A(x,O,m){b(x[0],c),b(x[1],u),b(x[2],u),b(x[3],c);for(let a=255;a>=0;--a){const g=m[a/8|0]>>(a&7)&1;k(x,O,g),Y(O,x),Y(x,x),k(x,O,g)}}function R(x,O){const m=[i(),i(),i(),i()];b(m[0],l),b(m[1],w),b(m[2],u),o(m[3],l,w),A(x,m,O)}function q(x){if(x.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const O=(0,r.hash)(x);O[0]&=248,O[31]&=127,O[31]|=64;const m=new Uint8Array(32),a=[i(),i(),i(),i()];R(a,O),J(m,a);const g=new Uint8Array(64);return g.set(x),g.set(m,32),{publicKey:m,secretKey:g}}t.generateKeyPairFromSeed=q;function $(x){const O=(0,e.randomBytes)(32,x),m=q(O);return(0,n.wipe)(O),m}t.generateKeyPair=$;function P(x){if(x.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(x.subarray(32))}t.extractPublicKeyFromSecretKey=P;const N=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(x,O){let m,a,g,H;for(a=63;a>=32;--a){for(m=0,g=a-32,H=a-12;g<H;++g)O[g]+=m-16*O[a]*N[g-(a-32)],m=Math.floor((O[g]+128)/256),O[g]-=m*256;O[g]+=m,O[a]=0}for(m=0,g=0;g<32;g++)O[g]+=m-(O[31]>>4)*N[g],m=O[g]>>8,O[g]&=255;for(g=0;g<32;g++)O[g]-=m*N[g];for(a=0;a<32;a++)O[a+1]+=O[a]>>8,x[a]=O[a]&255}function B(x){const O=new Float64Array(64);for(let m=0;m<64;m++)O[m]=x[m];for(let m=0;m<64;m++)x[m]=0;M(x,O)}function re(x,O){const m=new Float64Array(64),a=[i(),i(),i(),i()],g=(0,r.hash)(x.subarray(0,32));g[0]&=248,g[31]&=127,g[31]|=64;const H=new Uint8Array(64);H.set(g.subarray(32),32);const G=new r.SHA512;G.update(H.subarray(32)),G.update(O);const fe=G.digest();G.clean(),B(fe),R(a,fe),J(H,a),G.reset(),G.update(H.subarray(0,32)),G.update(x.subarray(32)),G.update(O);const ye=G.digest();B(ye);for(let le=0;le<32;le++)m[le]=fe[le];for(let le=0;le<32;le++)for(let ve=0;ve<32;ve++)m[le+ve]+=ye[le]*g[ve];return M(H.subarray(32),m),H}t.sign=re;function z(x,O){const m=i(),a=i(),g=i(),H=i(),G=i(),fe=i(),ye=i();return b(x[2],u),y(x[1],O),_(g,x[1]),o(H,g,h),p(g,g,x[2]),E(H,x[2],H),_(G,H),_(fe,G),o(ye,fe,G),o(m,ye,g),o(m,m,H),F(m,m),o(m,m,g),o(m,m,H),o(m,m,H),o(x[0],m,H),_(a,x[0]),o(a,a,H),S(a,g)&&o(x[0],x[0],v),_(a,x[0]),o(a,a,H),S(a,g)?-1:(I(x[0])===O[31]>>7&&p(x[0],c,x[0]),o(x[3],x[0],x[1]),0)}function Z(x,O,m){const a=new Uint8Array(32),g=[i(),i(),i(),i()],H=[i(),i(),i(),i()];if(m.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(z(H,x))return!1;const G=new r.SHA512;G.update(m.subarray(0,32)),G.update(x),G.update(O);const fe=G.digest();return B(fe),A(g,H,fe),R(H,m.subarray(32)),Y(g,H),J(a,g),!K(m,a)}t.verify=Z;function W(x){let O=[i(),i(),i(),i()];if(z(O,x))throw new Error("Ed25519: invalid public key");let m=i(),a=i(),g=O[1];E(m,u,g),p(a,u,g),j(a,a),o(m,m,a);let H=new Uint8Array(32);return L(H,m),H}t.convertPublicKeyToX25519=W;function oe(x){const O=(0,r.hash)(x.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const m=new Uint8Array(O.subarray(0,32));return(0,n.wipe)(O),m}t.convertSecretKeyToX25519=oe}(On);const If="EdDSA",Rf="JWT",as=".",cs="base64url",Af="utf8",Cf="utf8",Pf=":",Lf="did",Nf="key",us="base58btc",Uf="z",Mf="K36",jf=32;function fs(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function An(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=fs(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function $f(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),c=s.charCodeAt(0);if(r[c]!==255)throw new TypeError(s+" is ambiguous");r[c]=i}var u=t.length,h=t.charAt(0),f=Math.log(u)/Math.log(256),l=Math.log(256)/Math.log(u);function w(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var U=0,L=0,K=0,S=T.length;K!==S&&T[K]===0;)K++,U++;for(var I=(S-K)*l+1>>>0,y=new Uint8Array(I);K!==S;){for(var E=T[K],p=0,o=I-1;(E!==0||p<L)&&o!==-1;o--,p++)E+=256*y[o]>>>0,y[o]=E%u>>>0,E=E/u>>>0;if(E!==0)throw new Error("Non-zero carry");L=p,K++}for(var _=I-L;_!==I&&y[_]===0;)_++;for(var j=h.repeat(U);_<I;++_)j+=t.charAt(y[_]);return j}function v(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var U=0;if(T[U]!==" "){for(var L=0,K=0;T[U]===h;)L++,U++;for(var S=(T.length-U)*f+1>>>0,I=new Uint8Array(S);T[U];){var y=r[T.charCodeAt(U)];if(y===255)return;for(var E=0,p=S-1;(y!==0||E<K)&&p!==-1;p--,E++)y+=u*I[p]>>>0,I[p]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");K=E,U++}if(T[U]!==" "){for(var o=S-K;o!==S&&I[o]===0;)o++;for(var _=new Uint8Array(L+(S-o)),j=L;o!==S;)_[j++]=I[o++];return _}}}function b(T){var U=v(T);if(U)return U;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:v,decode:b}}var Ff=$f,Bf=Ff;const hs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},zf=t=>new TextEncoder().encode(t),Hf=t=>new TextDecoder().decode(t);class Kf{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Gf{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ls(this,e)}}class Vf{constructor(e){this.decoders=e}or(e){return ls(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ls=(t,e)=>new Vf({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class qf{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Kf(e,r,n),this.decoder=new Gf(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const jr=({name:t,prefix:e,encode:r,decode:n})=>new qf(t,e,r,n),lr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Bf(r,e);return jr({prefix:t,name:e,encode:n,decode:s=>hs(i(s))})},Wf=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const c=new Uint8Array(s*r/8|0);let u=0,h=0,f=0;for(let l=0;l<s;++l){const w=i[t[l]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|w,u+=r,u>=8&&(u-=8,c[f++]=255&h>>u)}if(u>=r||255&h<<8-u)throw new SyntaxError("Unexpected end of data");return c},Yf=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",c=0,u=0;for(let h=0;h<t.length;++h)for(u=u<<8|t[h],c+=8;c>r;)c-=r,s+=e[i&u>>c];if(c&&(s+=e[i&u<<r-c]),n)for(;s.length*r&7;)s+="=";return s},Je=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>jr({prefix:e,name:t,encode(i){return Yf(i,n,r)},decode(i){return Wf(i,n,r,t)}}),Xf=jr({prefix:"\0",name:"identity",encode:t=>Hf(t),decode:t=>zf(t)});var kf=Object.freeze({__proto__:null,identity:Xf});const Jf=Je({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Zf=Object.freeze({__proto__:null,base2:Jf});const Qf=Je({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var eh=Object.freeze({__proto__:null,base8:Qf});const th=lr({prefix:"9",name:"base10",alphabet:"0123456789"});var rh=Object.freeze({__proto__:null,base10:th});const nh=Je({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ih=Je({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var sh=Object.freeze({__proto__:null,base16:nh,base16upper:ih});const oh=Je({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ah=Je({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ch=Je({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),uh=Je({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fh=Je({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hh=Je({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),lh=Je({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),dh=Je({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_h=Je({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var gh=Object.freeze({__proto__:null,base32:oh,base32upper:ah,base32pad:ch,base32padupper:uh,base32hex:fh,base32hexupper:hh,base32hexpad:lh,base32hexpadupper:dh,base32z:_h});const yh=lr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ph=lr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var bh=Object.freeze({__proto__:null,base36:yh,base36upper:ph});const vh=lr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Eh=lr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var wh=Object.freeze({__proto__:null,base58btc:vh,base58flickr:Eh});const mh=Je({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Dh=Je({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Sh=Je({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Oh=Je({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var xh=Object.freeze({__proto__:null,base64:mh,base64pad:Dh,base64url:Sh,base64urlpad:Oh});const ds=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Th=ds.reduce((t,e,r)=>(t[r]=e,t),[]),Ih=ds.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Rh(t){return t.reduce((e,r)=>(e+=Th[r],e),"")}function Ah(t){const e=[];for(const r of t){const n=Ih[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const Ch=jr({prefix:"\u{1F680}",name:"base256emoji",encode:Rh,decode:Ah});var Ph=Object.freeze({__proto__:null,base256emoji:Ch}),Lh=gs,_s=128,Nh=127,Uh=~Nh,Mh=Math.pow(2,31);function gs(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Mh;)e[r++]=t&255|_s,t/=128;for(;t&Uh;)e[r++]=t&255|_s,t>>>=7;return e[r]=t|0,gs.bytes=r-n+1,e}var jh=Cn,$h=128,ys=127;function Cn(t,n){var r=0,n=n||0,i=0,s=n,c,u=t.length;do{if(s>=u)throw Cn.bytes=0,new RangeError("Could not decode varint");c=t[s++],r+=i<28?(c&ys)<<i:(c&ys)*Math.pow(2,i),i+=7}while(c>=$h);return Cn.bytes=s-n,r}var Fh=Math.pow(2,7),Bh=Math.pow(2,14),zh=Math.pow(2,21),Hh=Math.pow(2,28),Kh=Math.pow(2,35),Gh=Math.pow(2,42),Vh=Math.pow(2,49),qh=Math.pow(2,56),Wh=Math.pow(2,63),Yh=function(t){return t<Fh?1:t<Bh?2:t<zh?3:t<Hh?4:t<Kh?5:t<Gh?6:t<Vh?7:t<qh?8:t<Wh?9:10},Xh={encode:Lh,decode:jh,encodingLength:Yh},ps=Xh;const bs=(t,e,r=0)=>(ps.encode(t,e,r),e),vs=t=>ps.encodingLength(t),Pn=(t,e)=>{const r=e.byteLength,n=vs(t),i=n+vs(r),s=new Uint8Array(i+r);return bs(t,s,0),bs(r,s,n),s.set(e,i),new kh(t,r,e,s)};class kh{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Es=({name:t,code:e,encode:r})=>new Jh(t,e,r);class Jh{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Pn(this.code,r):r.then(n=>Pn(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ws=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Zh=Es({name:"sha2-256",code:18,encode:ws("SHA-256")}),Qh=Es({name:"sha2-512",code:19,encode:ws("SHA-512")});var el=Object.freeze({__proto__:null,sha256:Zh,sha512:Qh});const ms=0,tl="identity",Ds=hs;var rl=Object.freeze({__proto__:null,identity:{code:ms,name:tl,encode:Ds,digest:t=>Pn(ms,Ds(t))}});new TextEncoder,new TextDecoder;const Ss={...kf,...Zf,...eh,...rh,...sh,...gh,...bh,...wh,...xh,...Ph};({...el,...rl});function Os(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const xs=Os("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ln=Os("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=fs(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ts={utf8:xs,"utf-8":xs,hex:Ss.base16,latin1:Ln,ascii:Ln,binary:Ln,...Ss};function it(t,e="utf8"){const r=Ts[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function nt(t,e="utf8"){const r=Ts[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function $r(t){return it(nt(Sn(t),Af),cs)}function Is(t){const e=nt(Mf,us),r=Uf+it(An([e,t]),us);return[Lf,Nf,r].join(Pf)}function nl(t){return it(t,cs)}function il(t){return nt([$r(t.header),$r(t.payload)].join(as),Cf)}function sl(t){return[$r(t.header),$r(t.payload),nl(t.signature)].join(as)}function Rs(t=qt.randomBytes(jf)){return On.generateKeyPairFromSeed(t)}async function ol(t,e,r,n,i=De.fromMiliseconds(Date.now())){const s={alg:If,typ:Rf},c=Is(n.publicKey),u=i+r,h={iss:c,sub:t,aud:e,iat:i,exp:u},f=il({header:s,payload:h}),l=On.sign(n.secretKey,f);return sl({header:s,payload:h,signature:l})}var Nn={},Fr={};Object.defineProperty(Fr,"__esModule",{value:!0});var et=ee,Un=ot,al=20;function cl(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,c=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],w=r[19]<<24|r[18]<<16|r[17]<<8|r[16],v=r[23]<<24|r[22]<<16|r[21]<<8|r[20],b=r[27]<<24|r[26]<<16|r[25]<<8|r[24],T=r[31]<<24|r[30]<<16|r[29]<<8|r[28],U=e[3]<<24|e[2]<<16|e[1]<<8|e[0],L=e[7]<<24|e[6]<<16|e[5]<<8|e[4],K=e[11]<<24|e[10]<<16|e[9]<<8|e[8],S=e[15]<<24|e[14]<<16|e[13]<<8|e[12],I=n,y=i,E=s,p=c,o=u,_=h,j=f,F=l,Y=w,k=v,J=b,A=T,R=U,q=L,$=K,P=S,N=0;N<al;N+=2)I=I+o|0,R^=I,R=R>>>32-16|R<<16,Y=Y+R|0,o^=Y,o=o>>>32-12|o<<12,y=y+_|0,q^=y,q=q>>>32-16|q<<16,k=k+q|0,_^=k,_=_>>>32-12|_<<12,E=E+j|0,$^=E,$=$>>>32-16|$<<16,J=J+$|0,j^=J,j=j>>>32-12|j<<12,p=p+F|0,P^=p,P=P>>>32-16|P<<16,A=A+P|0,F^=A,F=F>>>32-12|F<<12,E=E+j|0,$^=E,$=$>>>32-8|$<<8,J=J+$|0,j^=J,j=j>>>32-7|j<<7,p=p+F|0,P^=p,P=P>>>32-8|P<<8,A=A+P|0,F^=A,F=F>>>32-7|F<<7,y=y+_|0,q^=y,q=q>>>32-8|q<<8,k=k+q|0,_^=k,_=_>>>32-7|_<<7,I=I+o|0,R^=I,R=R>>>32-8|R<<8,Y=Y+R|0,o^=Y,o=o>>>32-7|o<<7,I=I+_|0,P^=I,P=P>>>32-16|P<<16,J=J+P|0,_^=J,_=_>>>32-12|_<<12,y=y+j|0,R^=y,R=R>>>32-16|R<<16,A=A+R|0,j^=A,j=j>>>32-12|j<<12,E=E+F|0,q^=E,q=q>>>32-16|q<<16,Y=Y+q|0,F^=Y,F=F>>>32-12|F<<12,p=p+o|0,$^=p,$=$>>>32-16|$<<16,k=k+$|0,o^=k,o=o>>>32-12|o<<12,E=E+F|0,q^=E,q=q>>>32-8|q<<8,Y=Y+q|0,F^=Y,F=F>>>32-7|F<<7,p=p+o|0,$^=p,$=$>>>32-8|$<<8,k=k+$|0,o^=k,o=o>>>32-7|o<<7,y=y+j|0,R^=y,R=R>>>32-8|R<<8,A=A+R|0,j^=A,j=j>>>32-7|j<<7,I=I+_|0,P^=I,P=P>>>32-8|P<<8,J=J+P|0,_^=J,_=_>>>32-7|_<<7;et.writeUint32LE(I+n|0,t,0),et.writeUint32LE(y+i|0,t,4),et.writeUint32LE(E+s|0,t,8),et.writeUint32LE(p+c|0,t,12),et.writeUint32LE(o+u|0,t,16),et.writeUint32LE(_+h|0,t,20),et.writeUint32LE(j+f|0,t,24),et.writeUint32LE(F+l|0,t,28),et.writeUint32LE(Y+w|0,t,32),et.writeUint32LE(k+v|0,t,36),et.writeUint32LE(J+b|0,t,40),et.writeUint32LE(A+T|0,t,44),et.writeUint32LE(R+U|0,t,48),et.writeUint32LE(q+L|0,t,52),et.writeUint32LE($+K|0,t,56),et.writeUint32LE(P+S|0,t,60)}function As(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,c;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),c=s.length-e.length,s.set(e,c)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,c=i}for(var u=new Uint8Array(64),h=0;h<r.length;h+=64){cl(u,s,t);for(var f=h;f<h+64&&f<r.length;f++)n[f]=r[f]^u[f-h];fl(s,0,c)}return Un.wipe(u),i===0&&Un.wipe(s),n}Fr.streamXOR=As;function ul(t,e,r,n){return n===void 0&&(n=0),Un.wipe(r),As(t,e,r,r,n)}Fr.stream=ul;function fl(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var Cs={},Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});function hl(t,e,r){return~(t-1)&e|t-1&r}Ot.select=hl;function ll(t,e){return(t|0)-(e|0)-1>>>31&1}Ot.lessOrEqual=ll;function Ps(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}Ot.compare=Ps;function dl(t,e){return t.length===0||e.length===0?!1:Ps(t,e)!==0}Ot.equal=dl,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Ot,r=ot;t.DIGEST_LENGTH=16;var n=function(){function c(u){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=u[0]|u[1]<<8;this._r[0]=h&8191;var f=u[2]|u[3]<<8;this._r[1]=(h>>>13|f<<3)&8191;var l=u[4]|u[5]<<8;this._r[2]=(f>>>10|l<<6)&7939;var w=u[6]|u[7]<<8;this._r[3]=(l>>>7|w<<9)&8191;var v=u[8]|u[9]<<8;this._r[4]=(w>>>4|v<<12)&255,this._r[5]=v>>>1&8190;var b=u[10]|u[11]<<8;this._r[6]=(v>>>14|b<<2)&8191;var T=u[12]|u[13]<<8;this._r[7]=(b>>>11|T<<5)&8065;var U=u[14]|u[15]<<8;this._r[8]=(T>>>8|U<<8)&8191,this._r[9]=U>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return c.prototype._blocks=function(u,h,f){for(var l=this._fin?0:2048,w=this._h[0],v=this._h[1],b=this._h[2],T=this._h[3],U=this._h[4],L=this._h[5],K=this._h[6],S=this._h[7],I=this._h[8],y=this._h[9],E=this._r[0],p=this._r[1],o=this._r[2],_=this._r[3],j=this._r[4],F=this._r[5],Y=this._r[6],k=this._r[7],J=this._r[8],A=this._r[9];f>=16;){var R=u[h+0]|u[h+1]<<8;w+=R&8191;var q=u[h+2]|u[h+3]<<8;v+=(R>>>13|q<<3)&8191;var $=u[h+4]|u[h+5]<<8;b+=(q>>>10|$<<6)&8191;var P=u[h+6]|u[h+7]<<8;T+=($>>>7|P<<9)&8191;var N=u[h+8]|u[h+9]<<8;U+=(P>>>4|N<<12)&8191,L+=N>>>1&8191;var M=u[h+10]|u[h+11]<<8;K+=(N>>>14|M<<2)&8191;var B=u[h+12]|u[h+13]<<8;S+=(M>>>11|B<<5)&8191;var re=u[h+14]|u[h+15]<<8;I+=(B>>>8|re<<8)&8191,y+=re>>>5|l;var z=0,Z=z;Z+=w*E,Z+=v*(5*A),Z+=b*(5*J),Z+=T*(5*k),Z+=U*(5*Y),z=Z>>>13,Z&=8191,Z+=L*(5*F),Z+=K*(5*j),Z+=S*(5*_),Z+=I*(5*o),Z+=y*(5*p),z+=Z>>>13,Z&=8191;var W=z;W+=w*p,W+=v*E,W+=b*(5*A),W+=T*(5*J),W+=U*(5*k),z=W>>>13,W&=8191,W+=L*(5*Y),W+=K*(5*F),W+=S*(5*j),W+=I*(5*_),W+=y*(5*o),z+=W>>>13,W&=8191;var oe=z;oe+=w*o,oe+=v*p,oe+=b*E,oe+=T*(5*A),oe+=U*(5*J),z=oe>>>13,oe&=8191,oe+=L*(5*k),oe+=K*(5*Y),oe+=S*(5*F),oe+=I*(5*j),oe+=y*(5*_),z+=oe>>>13,oe&=8191;var x=z;x+=w*_,x+=v*o,x+=b*p,x+=T*E,x+=U*(5*A),z=x>>>13,x&=8191,x+=L*(5*J),x+=K*(5*k),x+=S*(5*Y),x+=I*(5*F),x+=y*(5*j),z+=x>>>13,x&=8191;var O=z;O+=w*j,O+=v*_,O+=b*o,O+=T*p,O+=U*E,z=O>>>13,O&=8191,O+=L*(5*A),O+=K*(5*J),O+=S*(5*k),O+=I*(5*Y),O+=y*(5*F),z+=O>>>13,O&=8191;var m=z;m+=w*F,m+=v*j,m+=b*_,m+=T*o,m+=U*p,z=m>>>13,m&=8191,m+=L*E,m+=K*(5*A),m+=S*(5*J),m+=I*(5*k),m+=y*(5*Y),z+=m>>>13,m&=8191;var a=z;a+=w*Y,a+=v*F,a+=b*j,a+=T*_,a+=U*o,z=a>>>13,a&=8191,a+=L*p,a+=K*E,a+=S*(5*A),a+=I*(5*J),a+=y*(5*k),z+=a>>>13,a&=8191;var g=z;g+=w*k,g+=v*Y,g+=b*F,g+=T*j,g+=U*_,z=g>>>13,g&=8191,g+=L*o,g+=K*p,g+=S*E,g+=I*(5*A),g+=y*(5*J),z+=g>>>13,g&=8191;var H=z;H+=w*J,H+=v*k,H+=b*Y,H+=T*F,H+=U*j,z=H>>>13,H&=8191,H+=L*_,H+=K*o,H+=S*p,H+=I*E,H+=y*(5*A),z+=H>>>13,H&=8191;var G=z;G+=w*A,G+=v*J,G+=b*k,G+=T*Y,G+=U*F,z=G>>>13,G&=8191,G+=L*j,G+=K*_,G+=S*o,G+=I*p,G+=y*E,z+=G>>>13,G&=8191,z=(z<<2)+z|0,z=z+Z|0,Z=z&8191,z=z>>>13,W+=z,w=Z,v=W,b=oe,T=x,U=O,L=m,K=a,S=g,I=H,y=G,h+=16,f-=16}this._h[0]=w,this._h[1]=v,this._h[2]=b,this._h[3]=T,this._h[4]=U,this._h[5]=L,this._h[6]=K,this._h[7]=S,this._h[8]=I,this._h[9]=y},c.prototype.finish=function(u,h){h===void 0&&(h=0);var f=new Uint16Array(10),l,w,v,b;if(this._leftover){for(b=this._leftover,this._buffer[b++]=1;b<16;b++)this._buffer[b]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(l=this._h[1]>>>13,this._h[1]&=8191,b=2;b<10;b++)this._h[b]+=l,l=this._h[b]>>>13,this._h[b]&=8191;for(this._h[0]+=l*5,l=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=l,l=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=l,f[0]=this._h[0]+5,l=f[0]>>>13,f[0]&=8191,b=1;b<10;b++)f[b]=this._h[b]+l,l=f[b]>>>13,f[b]&=8191;for(f[9]-=1<<13,w=(l^1)-1,b=0;b<10;b++)f[b]&=w;for(w=~w,b=0;b<10;b++)this._h[b]=this._h[b]&w|f[b];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,v=this._h[0]+this._pad[0],this._h[0]=v&65535,b=1;b<8;b++)v=(this._h[b]+this._pad[b]|0)+(v>>>16)|0,this._h[b]=v&65535;return u[h+0]=this._h[0]>>>0,u[h+1]=this._h[0]>>>8,u[h+2]=this._h[1]>>>0,u[h+3]=this._h[1]>>>8,u[h+4]=this._h[2]>>>0,u[h+5]=this._h[2]>>>8,u[h+6]=this._h[3]>>>0,u[h+7]=this._h[3]>>>8,u[h+8]=this._h[4]>>>0,u[h+9]=this._h[4]>>>8,u[h+10]=this._h[5]>>>0,u[h+11]=this._h[5]>>>8,u[h+12]=this._h[6]>>>0,u[h+13]=this._h[6]>>>8,u[h+14]=this._h[7]>>>0,u[h+15]=this._h[7]>>>8,this._finished=!0,this},c.prototype.update=function(u){var h=0,f=u.length,l;if(this._leftover){l=16-this._leftover,l>f&&(l=f);for(var w=0;w<l;w++)this._buffer[this._leftover+w]=u[h+w];if(f-=l,h+=l,this._leftover+=l,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(l=f-f%16,this._blocks(u,h,l),h+=l,f-=l),f){for(var w=0;w<f;w++)this._buffer[this._leftover+w]=u[h+w];this._leftover+=f}return this},c.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},c.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},c}();t.Poly1305=n;function i(c,u){var h=new n(c);h.update(u);var f=h.digest();return h.clean(),f}t.oneTimeAuth=i;function s(c,u){return c.length!==t.DIGEST_LENGTH||u.length!==t.DIGEST_LENGTH?!1:e.equal(c,u)}t.equal=s}(Cs),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Fr,r=Cs,n=ot,i=ee,s=Ot;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var c=new Uint8Array(16),u=function(){function h(f){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,f.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return h.prototype.seal=function(f,l,w,v){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var b=new Uint8Array(16);b.set(f,b.length-f.length);var T=new Uint8Array(32);e.stream(this._key,b,T,4);var U=l.length+this.tagLength,L;if(v){if(v.length!==U)throw new Error("ChaCha20Poly1305: incorrect destination length");L=v}else L=new Uint8Array(U);return e.streamXOR(this._key,b,l,L,4),this._authenticate(L.subarray(L.length-this.tagLength,L.length),T,L.subarray(0,L.length-this.tagLength),w),n.wipe(b),L},h.prototype.open=function(f,l,w,v){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(l.length<this.tagLength)return null;var b=new Uint8Array(16);b.set(f,b.length-f.length);var T=new Uint8Array(32);e.stream(this._key,b,T,4);var U=new Uint8Array(this.tagLength);if(this._authenticate(U,T,l.subarray(0,l.length-this.tagLength),w),!s.equal(U,l.subarray(l.length-this.tagLength,l.length)))return null;var L=l.length-this.tagLength,K;if(v){if(v.length!==L)throw new Error("ChaCha20Poly1305: incorrect destination length");K=v}else K=new Uint8Array(L);return e.streamXOR(this._key,b,l.subarray(0,l.length-this.tagLength),K,4),n.wipe(b),K},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(f,l,w,v){var b=new r.Poly1305(l);v&&(b.update(v),v.length%16>0&&b.update(c.subarray(v.length%16))),b.update(w),w.length%16>0&&b.update(c.subarray(w.length%16));var T=new Uint8Array(8);v&&i.writeUint64LE(v.length,T),b.update(T),i.writeUint64LE(w.length,T),b.update(T);for(var U=b.digest(),L=0;L<U.length;L++)f[L]=U[L];b.clean(),n.wipe(U),n.wipe(T)},h}();t.ChaCha20Poly1305=u}(Nn);var Ls={},dr={},Mn={};Object.defineProperty(Mn,"__esModule",{value:!0});function _l(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Mn.isSerializableHash=_l,Object.defineProperty(dr,"__esModule",{value:!0});var bt=Mn,gl=Ot,yl=ot,Ns=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),bt.isSerializableHash(this._inner)&&bt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),yl.wipe(n)}return t.prototype.reset=function(){if(!bt.isSerializableHash(this._inner)||!bt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){bt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),bt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!bt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!bt.isSerializableHash(this._inner)||!bt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!bt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();dr.HMAC=Ns;function pl(t,e,r){var n=new Ns(t,e);n.update(r);var i=n.digest();return n.clean(),i}dr.hmac=pl,dr.equal=gl.equal,Object.defineProperty(Ls,"__esModule",{value:!0});var Us=dr,Ms=ot,bl=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=Us.hmac(this._hash,n,r);this._hmac=new Us.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Ms.wipe(this._buffer),Ms.wipe(this._counter),this._bufpos=0},t}(),vl=Ls.HKDF=bl,Br={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ee,r=ot;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._temp,this._state,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},u.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,w=f/536870912|0,v=f<<3,b=f%64<56?64:128;this._buffer[l]=128;for(var T=l+1;T<b-8;T++)this._buffer[T]=0;e.writeUint32BE(w,this._buffer,b-8),e.writeUint32BE(v,this._buffer,b-4),s(this._temp,this._state,this._buffer,0,b),this._finished=!0}for(var T=0;T<this.digestLength/4;T++)e.writeUint32BE(this._state[T],h,T*4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(u,h,f,l,w){for(;w>=64;){for(var v=h[0],b=h[1],T=h[2],U=h[3],L=h[4],K=h[5],S=h[6],I=h[7],y=0;y<16;y++){var E=l+y*4;u[y]=e.readUint32BE(f,E)}for(var y=16;y<64;y++){var p=u[y-2],o=(p>>>17|p<<32-17)^(p>>>19|p<<32-19)^p>>>10;p=u[y-15];var _=(p>>>7|p<<32-7)^(p>>>18|p<<32-18)^p>>>3;u[y]=(o+u[y-7]|0)+(_+u[y-16]|0)}for(var y=0;y<64;y++){var o=(((L>>>6|L<<26)^(L>>>11|L<<21)^(L>>>25|L<<7))+(L&K^~L&S)|0)+(I+(i[y]+u[y]|0)|0)|0,_=((v>>>2|v<<32-2)^(v>>>13|v<<32-13)^(v>>>22|v<<32-22))+(v&b^v&T^b&T)|0;I=S,S=K,K=L,L=U+o|0,U=T,T=b,b=v,v=o+_|0}h[0]+=v,h[1]+=b,h[2]+=T,h[3]+=U,h[4]+=L,h[5]+=K,h[6]+=S,h[7]+=I,l+=64,w-=64}return l}function c(u){var h=new n;h.update(u);var f=h.digest();return h.clean(),f}t.hash=c})(Br);var jn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=qt,r=ot;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(y){const E=new Float64Array(16);if(y)for(let p=0;p<y.length;p++)E[p]=y[p];return E}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function c(y){let E=1;for(let p=0;p<16;p++){let o=y[p]+E+65535;E=Math.floor(o/65536),y[p]=o-E*65536}y[0]+=E-1+37*(E-1)}function u(y,E,p){const o=~(p-1);for(let _=0;_<16;_++){const j=o&(y[_]^E[_]);y[_]^=j,E[_]^=j}}function h(y,E){const p=n(),o=n();for(let _=0;_<16;_++)o[_]=E[_];c(o),c(o),c(o);for(let _=0;_<2;_++){p[0]=o[0]-65517;for(let F=1;F<15;F++)p[F]=o[F]-65535-(p[F-1]>>16&1),p[F-1]&=65535;p[15]=o[15]-32767-(p[14]>>16&1);const j=p[15]>>16&1;p[14]&=65535,u(o,p,1-j)}for(let _=0;_<16;_++)y[2*_]=o[_]&255,y[2*_+1]=o[_]>>8}function f(y,E){for(let p=0;p<16;p++)y[p]=E[2*p]+(E[2*p+1]<<8);y[15]&=32767}function l(y,E,p){for(let o=0;o<16;o++)y[o]=E[o]+p[o]}function w(y,E,p){for(let o=0;o<16;o++)y[o]=E[o]-p[o]}function v(y,E,p){let o,_,j=0,F=0,Y=0,k=0,J=0,A=0,R=0,q=0,$=0,P=0,N=0,M=0,B=0,re=0,z=0,Z=0,W=0,oe=0,x=0,O=0,m=0,a=0,g=0,H=0,G=0,fe=0,ye=0,le=0,ve=0,Ue=0,Ce=0,ge=p[0],de=p[1],he=p[2],ce=p[3],ae=p[4],se=p[5],ie=p[6],Q=p[7],ue=p[8],_e=p[9],te=p[10],pe=p[11],be=p[12],we=p[13],me=p[14],Ee=p[15];o=E[0],j+=o*ge,F+=o*de,Y+=o*he,k+=o*ce,J+=o*ae,A+=o*se,R+=o*ie,q+=o*Q,$+=o*ue,P+=o*_e,N+=o*te,M+=o*pe,B+=o*be,re+=o*we,z+=o*me,Z+=o*Ee,o=E[1],F+=o*ge,Y+=o*de,k+=o*he,J+=o*ce,A+=o*ae,R+=o*se,q+=o*ie,$+=o*Q,P+=o*ue,N+=o*_e,M+=o*te,B+=o*pe,re+=o*be,z+=o*we,Z+=o*me,W+=o*Ee,o=E[2],Y+=o*ge,k+=o*de,J+=o*he,A+=o*ce,R+=o*ae,q+=o*se,$+=o*ie,P+=o*Q,N+=o*ue,M+=o*_e,B+=o*te,re+=o*pe,z+=o*be,Z+=o*we,W+=o*me,oe+=o*Ee,o=E[3],k+=o*ge,J+=o*de,A+=o*he,R+=o*ce,q+=o*ae,$+=o*se,P+=o*ie,N+=o*Q,M+=o*ue,B+=o*_e,re+=o*te,z+=o*pe,Z+=o*be,W+=o*we,oe+=o*me,x+=o*Ee,o=E[4],J+=o*ge,A+=o*de,R+=o*he,q+=o*ce,$+=o*ae,P+=o*se,N+=o*ie,M+=o*Q,B+=o*ue,re+=o*_e,z+=o*te,Z+=o*pe,W+=o*be,oe+=o*we,x+=o*me,O+=o*Ee,o=E[5],A+=o*ge,R+=o*de,q+=o*he,$+=o*ce,P+=o*ae,N+=o*se,M+=o*ie,B+=o*Q,re+=o*ue,z+=o*_e,Z+=o*te,W+=o*pe,oe+=o*be,x+=o*we,O+=o*me,m+=o*Ee,o=E[6],R+=o*ge,q+=o*de,$+=o*he,P+=o*ce,N+=o*ae,M+=o*se,B+=o*ie,re+=o*Q,z+=o*ue,Z+=o*_e,W+=o*te,oe+=o*pe,x+=o*be,O+=o*we,m+=o*me,a+=o*Ee,o=E[7],q+=o*ge,$+=o*de,P+=o*he,N+=o*ce,M+=o*ae,B+=o*se,re+=o*ie,z+=o*Q,Z+=o*ue,W+=o*_e,oe+=o*te,x+=o*pe,O+=o*be,m+=o*we,a+=o*me,g+=o*Ee,o=E[8],$+=o*ge,P+=o*de,N+=o*he,M+=o*ce,B+=o*ae,re+=o*se,z+=o*ie,Z+=o*Q,W+=o*ue,oe+=o*_e,x+=o*te,O+=o*pe,m+=o*be,a+=o*we,g+=o*me,H+=o*Ee,o=E[9],P+=o*ge,N+=o*de,M+=o*he,B+=o*ce,re+=o*ae,z+=o*se,Z+=o*ie,W+=o*Q,oe+=o*ue,x+=o*_e,O+=o*te,m+=o*pe,a+=o*be,g+=o*we,H+=o*me,G+=o*Ee,o=E[10],N+=o*ge,M+=o*de,B+=o*he,re+=o*ce,z+=o*ae,Z+=o*se,W+=o*ie,oe+=o*Q,x+=o*ue,O+=o*_e,m+=o*te,a+=o*pe,g+=o*be,H+=o*we,G+=o*me,fe+=o*Ee,o=E[11],M+=o*ge,B+=o*de,re+=o*he,z+=o*ce,Z+=o*ae,W+=o*se,oe+=o*ie,x+=o*Q,O+=o*ue,m+=o*_e,a+=o*te,g+=o*pe,H+=o*be,G+=o*we,fe+=o*me,ye+=o*Ee,o=E[12],B+=o*ge,re+=o*de,z+=o*he,Z+=o*ce,W+=o*ae,oe+=o*se,x+=o*ie,O+=o*Q,m+=o*ue,a+=o*_e,g+=o*te,H+=o*pe,G+=o*be,fe+=o*we,ye+=o*me,le+=o*Ee,o=E[13],re+=o*ge,z+=o*de,Z+=o*he,W+=o*ce,oe+=o*ae,x+=o*se,O+=o*ie,m+=o*Q,a+=o*ue,g+=o*_e,H+=o*te,G+=o*pe,fe+=o*be,ye+=o*we,le+=o*me,ve+=o*Ee,o=E[14],z+=o*ge,Z+=o*de,W+=o*he,oe+=o*ce,x+=o*ae,O+=o*se,m+=o*ie,a+=o*Q,g+=o*ue,H+=o*_e,G+=o*te,fe+=o*pe,ye+=o*be,le+=o*we,ve+=o*me,Ue+=o*Ee,o=E[15],Z+=o*ge,W+=o*de,oe+=o*he,x+=o*ce,O+=o*ae,m+=o*se,a+=o*ie,g+=o*Q,H+=o*ue,G+=o*_e,fe+=o*te,ye+=o*pe,le+=o*be,ve+=o*we,Ue+=o*me,Ce+=o*Ee,j+=38*W,F+=38*oe,Y+=38*x,k+=38*O,J+=38*m,A+=38*a,R+=38*g,q+=38*H,$+=38*G,P+=38*fe,N+=38*ye,M+=38*le,B+=38*ve,re+=38*Ue,z+=38*Ce,_=1,o=j+_+65535,_=Math.floor(o/65536),j=o-_*65536,o=F+_+65535,_=Math.floor(o/65536),F=o-_*65536,o=Y+_+65535,_=Math.floor(o/65536),Y=o-_*65536,o=k+_+65535,_=Math.floor(o/65536),k=o-_*65536,o=J+_+65535,_=Math.floor(o/65536),J=o-_*65536,o=A+_+65535,_=Math.floor(o/65536),A=o-_*65536,o=R+_+65535,_=Math.floor(o/65536),R=o-_*65536,o=q+_+65535,_=Math.floor(o/65536),q=o-_*65536,o=$+_+65535,_=Math.floor(o/65536),$=o-_*65536,o=P+_+65535,_=Math.floor(o/65536),P=o-_*65536,o=N+_+65535,_=Math.floor(o/65536),N=o-_*65536,o=M+_+65535,_=Math.floor(o/65536),M=o-_*65536,o=B+_+65535,_=Math.floor(o/65536),B=o-_*65536,o=re+_+65535,_=Math.floor(o/65536),re=o-_*65536,o=z+_+65535,_=Math.floor(o/65536),z=o-_*65536,o=Z+_+65535,_=Math.floor(o/65536),Z=o-_*65536,j+=_-1+37*(_-1),_=1,o=j+_+65535,_=Math.floor(o/65536),j=o-_*65536,o=F+_+65535,_=Math.floor(o/65536),F=o-_*65536,o=Y+_+65535,_=Math.floor(o/65536),Y=o-_*65536,o=k+_+65535,_=Math.floor(o/65536),k=o-_*65536,o=J+_+65535,_=Math.floor(o/65536),J=o-_*65536,o=A+_+65535,_=Math.floor(o/65536),A=o-_*65536,o=R+_+65535,_=Math.floor(o/65536),R=o-_*65536,o=q+_+65535,_=Math.floor(o/65536),q=o-_*65536,o=$+_+65535,_=Math.floor(o/65536),$=o-_*65536,o=P+_+65535,_=Math.floor(o/65536),P=o-_*65536,o=N+_+65535,_=Math.floor(o/65536),N=o-_*65536,o=M+_+65535,_=Math.floor(o/65536),M=o-_*65536,o=B+_+65535,_=Math.floor(o/65536),B=o-_*65536,o=re+_+65535,_=Math.floor(o/65536),re=o-_*65536,o=z+_+65535,_=Math.floor(o/65536),z=o-_*65536,o=Z+_+65535,_=Math.floor(o/65536),Z=o-_*65536,j+=_-1+37*(_-1),y[0]=j,y[1]=F,y[2]=Y,y[3]=k,y[4]=J,y[5]=A,y[6]=R,y[7]=q,y[8]=$,y[9]=P,y[10]=N,y[11]=M,y[12]=B,y[13]=re,y[14]=z,y[15]=Z}function b(y,E){v(y,E,E)}function T(y,E){const p=n();for(let o=0;o<16;o++)p[o]=E[o];for(let o=253;o>=0;o--)b(p,p),o!==2&&o!==4&&v(p,p,E);for(let o=0;o<16;o++)y[o]=p[o]}function U(y,E){const p=new Uint8Array(32),o=new Float64Array(80),_=n(),j=n(),F=n(),Y=n(),k=n(),J=n();for(let $=0;$<31;$++)p[$]=y[$];p[31]=y[31]&127|64,p[0]&=248,f(o,E);for(let $=0;$<16;$++)j[$]=o[$];_[0]=Y[0]=1;for(let $=254;$>=0;--$){const P=p[$>>>3]>>>($&7)&1;u(_,j,P),u(F,Y,P),l(k,_,F),w(_,_,F),l(F,j,Y),w(j,j,Y),b(Y,k),b(J,_),v(_,F,_),v(F,j,k),l(k,_,F),w(_,_,F),b(j,_),w(F,Y,J),v(_,F,s),l(_,_,Y),v(F,F,_),v(_,Y,J),v(Y,j,o),b(j,k),u(_,j,P),u(F,Y,P)}for(let $=0;$<16;$++)o[$+16]=_[$],o[$+32]=F[$],o[$+48]=j[$],o[$+64]=Y[$];const A=o.subarray(32),R=o.subarray(16);T(A,A),v(R,R,A);const q=new Uint8Array(32);return h(q,R),q}t.scalarMult=U;function L(y){return U(y,i)}t.scalarMultBase=L;function K(y){if(y.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const E=new Uint8Array(y);return{publicKey:L(E),secretKey:E}}t.generateKeyPairFromSeed=K;function S(y){const E=(0,e.randomBytes)(32,y),p=K(E);return(0,r.wipe)(E),p}t.generateKeyPair=S;function I(y,E,p=!1){if(y.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(E.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=U(y,E);if(p){let _=0;for(let j=0;j<o.length;j++)_|=o[j];if(_===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=I})(jn);var js=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},El=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),wl=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),ml=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),Dl=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Sl=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Ol=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,xl=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,$s=3,Tl=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Ol]],Fs=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Il(t){return t?Bs(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Sl:typeof navigator<"u"?Bs(navigator.userAgent):Cl()}function Rl(t){return t!==""&&Tl.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function Bs(t){var e=Rl(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new Dl;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<$s&&(i=js(js([],i,!0),Pl($s-i.length),!0)):i=[];var s=i.join("."),c=Al(t),u=xl.exec(t);return u&&u[1]?new ml(r,s,c,u[1]):new El(r,s,c)}function Al(t){for(var e=0,r=Fs.length;e<r;e++){var n=Fs[e],i=n[0],s=n[1],c=s.exec(t);if(c)return i}return null}function Cl(){var t=typeof process<"u"&&process.version;return t?new wl(process.version.slice(1)):null}function Pl(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=Hs=Oe.getLocation=Oe.getLocationOrThrow=$n=Oe.getNavigator=Oe.getNavigatorOrThrow=zs=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Mt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Oe.getFromWindow=Mt;function Wt(t){const e=Mt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Oe.getFromWindowOrThrow=Wt;function Ll(){return Wt("document")}Oe.getDocumentOrThrow=Ll;function Nl(){return Mt("document")}var zs=Oe.getDocument=Nl;function Ul(){return Wt("navigator")}Oe.getNavigatorOrThrow=Ul;function Ml(){return Mt("navigator")}var $n=Oe.getNavigator=Ml;function jl(){return Wt("location")}Oe.getLocationOrThrow=jl;function $l(){return Mt("location")}var Hs=Oe.getLocation=$l;function Fl(){return Wt("crypto")}Oe.getCryptoOrThrow=Fl;function Bl(){return Mt("crypto")}Oe.getCrypto=Bl;function zl(){return Wt("localStorage")}Oe.getLocalStorageOrThrow=zl;function Hl(){return Mt("localStorage")}Oe.getLocalStorage=Hl;var Fn={};Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.getWindowMetadata=void 0;const Ks=Oe;function Kl(){let t,e;try{t=Ks.getDocumentOrThrow(),e=Ks.getLocationOrThrow()}catch{return null}function r(){const w=t.getElementsByTagName("link"),v=[];for(let b=0;b<w.length;b++){const T=w[b],U=T.getAttribute("rel");if(U&&U.toLowerCase().indexOf("icon")>-1){const L=T.getAttribute("href");if(L)if(L.toLowerCase().indexOf("https:")===-1&&L.toLowerCase().indexOf("http:")===-1&&L.indexOf("//")!==0){let K=e.protocol+"//"+e.host;if(L.indexOf("/")===0)K+=L;else{const S=e.pathname.split("/");S.pop();const I=S.join("/");K+=I+"/"+L}v.push(K)}else if(L.indexOf("//")===0){const K=e.protocol+L;v.push(K)}else v.push(L)}}return v}function n(...w){const v=t.getElementsByTagName("meta");for(let b=0;b<v.length;b++){const T=v[b],U=["itemprop","property","name"].map(L=>T.getAttribute(L)).filter(L=>L?w.includes(L):!1);if(U.length&&U){const L=T.getAttribute("content");if(L)return L}}return""}function i(){let w=n("name","og:site_name","og:title","twitter:title");return w||(w=t.title),w}function s(){return n("description","og:description","twitter:description","keywords")}const c=i(),u=s(),h=e.origin,f=r();return{description:u,url:h,icons:f,name:c}}Fn.getWindowMetadata=Kl;var _r={},Gl=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Gs="%[a-f0-9]{2}",Vs=new RegExp("("+Gs+")|([^%]+?)","gi"),qs=new RegExp("("+Gs+")+","gi");function Bn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],Bn(r),Bn(n))}function Vl(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Vs)||[],r=1;r<e.length;r++)t=Bn(e,r).join(""),e=t.match(Vs)||[];return t}}function ql(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=qs.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=Vl(r[0]);n!==r[0]&&(e[r[0]]=n)}r=qs.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),s=0;s<i.length;s++){var c=i[s];t=t.replace(new RegExp(c,"g"),e[c])}return t}var Wl=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return ql(t)}},Yl=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Xl=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),s=0;s<n.length;s++){var c=n[s],u=t[c];(i?e.indexOf(c)!==-1:e(c,u,t))&&(r[c]=u)}return r};(function(t){const e=Gl,r=Wl,n=Yl,i=Xl,s=S=>S==null,c=Symbol("encodeFragmentIdentifier");function u(S){switch(S.arrayFormat){case"index":return I=>(y,E)=>{const p=y.length;return E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?y:E===null?[...y,[l(I,S),"[",p,"]"].join("")]:[...y,[l(I,S),"[",l(p,S),"]=",l(E,S)].join("")]};case"bracket":return I=>(y,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?y:E===null?[...y,[l(I,S),"[]"].join("")]:[...y,[l(I,S),"[]=",l(E,S)].join("")];case"colon-list-separator":return I=>(y,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?y:E===null?[...y,[l(I,S),":list="].join("")]:[...y,[l(I,S),":list=",l(E,S)].join("")];case"comma":case"separator":case"bracket-separator":{const I=S.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(E,p)=>p===void 0||S.skipNull&&p===null||S.skipEmptyString&&p===""?E:(p=p===null?"":p,E.length===0?[[l(y,S),I,l(p,S)].join("")]:[[E,l(p,S)].join(S.arrayFormatSeparator)])}default:return I=>(y,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?y:E===null?[...y,l(I,S)]:[...y,[l(I,S),"=",l(E,S)].join("")]}}function h(S){let I;switch(S.arrayFormat){case"index":return(y,E,p)=>{if(I=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!I){p[y]=E;return}p[y]===void 0&&(p[y]={}),p[y][I[1]]=E};case"bracket":return(y,E,p)=>{if(I=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!I){p[y]=E;return}if(p[y]===void 0){p[y]=[E];return}p[y]=[].concat(p[y],E)};case"colon-list-separator":return(y,E,p)=>{if(I=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!I){p[y]=E;return}if(p[y]===void 0){p[y]=[E];return}p[y]=[].concat(p[y],E)};case"comma":case"separator":return(y,E,p)=>{const o=typeof E=="string"&&E.includes(S.arrayFormatSeparator),_=typeof E=="string"&&!o&&w(E,S).includes(S.arrayFormatSeparator);E=_?w(E,S):E;const j=o||_?E.split(S.arrayFormatSeparator).map(F=>w(F,S)):E===null?E:w(E,S);p[y]=j};case"bracket-separator":return(y,E,p)=>{const o=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!o){p[y]=E&&w(E,S);return}const _=E===null?[]:E.split(S.arrayFormatSeparator).map(j=>w(j,S));if(p[y]===void 0){p[y]=_;return}p[y]=[].concat(p[y],_)};default:return(y,E,p)=>{if(p[y]===void 0){p[y]=E;return}p[y]=[].concat(p[y],E)}}}function f(S){if(typeof S!="string"||S.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function l(S,I){return I.encode?I.strict?e(S):encodeURIComponent(S):S}function w(S,I){return I.decode?r(S):S}function v(S){return Array.isArray(S)?S.sort():typeof S=="object"?v(Object.keys(S)).sort((I,y)=>Number(I)-Number(y)).map(I=>S[I]):S}function b(S){const I=S.indexOf("#");return I!==-1&&(S=S.slice(0,I)),S}function T(S){let I="";const y=S.indexOf("#");return y!==-1&&(I=S.slice(y)),I}function U(S){S=b(S);const I=S.indexOf("?");return I===-1?"":S.slice(I+1)}function L(S,I){return I.parseNumbers&&!Number.isNaN(Number(S))&&typeof S=="string"&&S.trim()!==""?S=Number(S):I.parseBooleans&&S!==null&&(S.toLowerCase()==="true"||S.toLowerCase()==="false")&&(S=S.toLowerCase()==="true"),S}function K(S,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),f(I.arrayFormatSeparator);const y=h(I),E=Object.create(null);if(typeof S!="string"||(S=S.trim().replace(/^[?#&]/,""),!S))return E;for(const p of S.split("&")){if(p==="")continue;let[o,_]=n(I.decode?p.replace(/\+/g," "):p,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?_:w(_,I),y(w(o,I),_,E)}for(const p of Object.keys(E)){const o=E[p];if(typeof o=="object"&&o!==null)for(const _ of Object.keys(o))o[_]=L(o[_],I);else E[p]=L(o,I)}return I.sort===!1?E:(I.sort===!0?Object.keys(E).sort():Object.keys(E).sort(I.sort)).reduce((p,o)=>{const _=E[o];return Boolean(_)&&typeof _=="object"&&!Array.isArray(_)?p[o]=v(_):p[o]=_,p},Object.create(null))}t.extract=U,t.parse=K,t.stringify=(S,I)=>{if(!S)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),f(I.arrayFormatSeparator);const y=_=>I.skipNull&&s(S[_])||I.skipEmptyString&&S[_]==="",E=u(I),p={};for(const _ of Object.keys(S))y(_)||(p[_]=S[_]);const o=Object.keys(p);return I.sort!==!1&&o.sort(I.sort),o.map(_=>{const j=S[_];return j===void 0?"":j===null?l(_,I):Array.isArray(j)?j.length===0&&I.arrayFormat==="bracket-separator"?l(_,I)+"[]":j.reduce(E(_),[]).join("&"):l(_,I)+"="+l(j,I)}).filter(_=>_.length>0).join("&")},t.parseUrl=(S,I)=>{I=Object.assign({decode:!0},I);const[y,E]=n(S,"#");return Object.assign({url:y.split("?")[0]||"",query:K(U(S),I)},I&&I.parseFragmentIdentifier&&E?{fragmentIdentifier:w(E,I)}:{})},t.stringifyUrl=(S,I)=>{I=Object.assign({encode:!0,strict:!0,[c]:!0},I);const y=b(S.url).split("?")[0]||"",E=t.extract(S.url),p=t.parse(E,{sort:!1}),o=Object.assign(p,S.query);let _=t.stringify(o,I);_&&(_=`?${_}`);let j=T(S.url);return S.fragmentIdentifier&&(j=`#${I[c]?l(S.fragmentIdentifier,I):S.fragmentIdentifier}`),`${y}${_}${j}`},t.pick=(S,I,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[c]:!1},y);const{url:E,query:p,fragmentIdentifier:o}=t.parseUrl(S,y);return t.stringifyUrl({url:E,query:i(p,I),fragmentIdentifier:o},y)},t.exclude=(S,I,y)=>{const E=Array.isArray(I)?p=>!I.includes(p):(p,o)=>!I(p,o);return t.pick(S,E,y)}})(_r);const kl={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Ws="base10",st="base16",zn="base64pad",Hn="utf8",Ys=0,Yt=1,Jl=0,Xs=1,Kn=12,Gn=32;function Zl(){const t=jn.generateKeyPair();return{privateKey:it(t.secretKey,st),publicKey:it(t.publicKey,st)}}function Vn(){const t=qt.randomBytes(Gn);return it(t,st)}function Ql(t,e){const r=jn.sharedKey(nt(t,st),nt(e,st)),n=new vl(Br.SHA256,r).expand(Gn);return it(n,st)}function ed(t){const e=Br.hash(nt(t,st));return it(e,st)}function zr(t){const e=Br.hash(nt(t,Hn));return it(e,st)}function td(t){return nt(`${t}`,Ws)}function gr(t){return Number(it(t,Ws))}function rd(t){const e=td(typeof t.type<"u"?t.type:Ys);if(gr(e)===Yt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?nt(t.senderPublicKey,st):void 0,n=typeof t.iv<"u"?nt(t.iv,st):qt.randomBytes(Kn),i=new Nn.ChaCha20Poly1305(nt(t.symKey,st)).seal(n,nt(t.message,Hn));return id({type:e,sealed:i,iv:n,senderPublicKey:r})}function nd(t){const e=new Nn.ChaCha20Poly1305(nt(t.symKey,st)),{sealed:r,iv:n}=qn(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return it(i,Hn)}function id(t){if(gr(t.type)===Yt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return it(An([t.type,t.senderPublicKey,t.iv,t.sealed]),zn)}return it(An([t.type,t.iv,t.sealed]),zn)}function qn(t){const e=nt(t,zn),r=e.slice(Jl,Xs),n=Xs;if(gr(r)===Yt){const u=n+Gn,h=u+Kn,f=e.slice(n,u),l=e.slice(u,h),w=e.slice(h);return{type:r,sealed:w,iv:l,senderPublicKey:f}}const i=n+Kn,s=e.slice(n,i),c=e.slice(i);return{type:r,sealed:c,iv:s}}function sd(t,e){const r=qn(t);return ks({type:gr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?it(r.senderPublicKey,st):void 0,receiverPublicKey:e?.receiverPublicKey})}function ks(t){const e=t?.type||Ys;if(e===Yt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Js(t){return t.type===Yt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var od=Object.defineProperty,Zs=Object.getOwnPropertySymbols,ad=Object.prototype.hasOwnProperty,cd=Object.prototype.propertyIsEnumerable,Qs=(t,e,r)=>e in t?od(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,eo=(t,e)=>{for(var r in e||(e={}))ad.call(e,r)&&Qs(t,r,e[r]);if(Zs)for(var r of Zs(e))cd.call(e,r)&&Qs(t,r,e[r]);return t};const ud="ReactNative",yr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},fd="js";function to(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function hd(){return!zs()&&!!$n()&&navigator.product===ud}function ld(){return!to()&&!!$n()}function dd(){return hd()?yr.reactNative:to()?yr.node:ld()?yr.browser:yr.unknown}function _d(t,e){let r=_r.parse(t);return r=eo(eo({},r),e),t=_r.stringify(r),t}function gd(){const t=Il();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function yd(){var t;const e=dd();return e===yr.browser?[e,((t=Hs())==null?void 0:t.host)||"unknown"].join(":"):e}function pd(t,e,r){const n=gd(),i=yd();return[[t,e].join("-"),[fd,r].join("-"),n,i].join("/")}function bd({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:c}){const u=r.split("?"),h=pd(t,e,n),f={auth:i,ua:h,projectId:s,useOnCloseEvent:c||void 0},l=_d(u[1]||"",f);return u[0]+"?"+l}function ro(t){return Object.fromEntries(t.entries())}function no(t){return new Map(Object.entries(t))}function vd(t=De.FIVE_MINUTES,e){const r=De.toMiliseconds(t||De.FIVE_MINUTES);let n,i,s;return{resolve:c=>{s&&n&&(clearTimeout(s),n(c))},reject:c=>{s&&i&&(clearTimeout(s),i(c))},done:()=>new Promise((c,u)=>{s=setTimeout(()=>{u(new Error(e))},r),n=c,i=u})}}function Hr(t,e,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),e);try{const c=await t;n(c)}catch(c){i(c)}clearTimeout(s)})}function io(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Ed(t){return io("topic",t)}function wd(t){return io("id",t)}function md(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Wn(t,e){return De.fromMiliseconds((e||Date.now())+De.toMiliseconds(t))}function so(t){return Date.now()>=De.toMiliseconds(t)}function Yn(t,e){return`${t}${e?`:${e}`:""}`}const Dd="irn";function Xn(t){return t?.relay||{protocol:Dd}}function Kr(t){const e=kl[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Sd=Object.defineProperty,oo=Object.getOwnPropertySymbols,Od=Object.prototype.hasOwnProperty,xd=Object.prototype.propertyIsEnumerable,ao=(t,e,r)=>e in t?Sd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Td=(t,e)=>{for(var r in e||(e={}))Od.call(e,r)&&ao(t,r,e[r]);if(oo)for(var r of oo(e))xd.call(e,r)&&ao(t,r,e[r]);return t};function Id(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),c=t[i];r[s]=c}}),r}function Rd(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",c=_r.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:c.symKey,relay:Id(c)}}function Ad(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=r+e+i;t[i]&&(n[s]=t[i])}),n}function Cd(t){return`${t.protocol}:${t.topic}@${t.version}?`+_r.stringify(Td({symKey:t.symKey},Ad(t.relay)))}const Pd={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ld={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function xe(t,e){const{message:r,code:n}=Ld[t];return{message:e?`${r} ${e}`:r,code:n}}function pr(t,e){const{message:r,code:n}=Pd[t];return{message:e?`${r} ${e}`:r,code:n}}function Nd(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Gr(t){return typeof t>"u"}function co(t,e){return e&&Gr(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function Ud(t){if(co(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Md(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function jd(t){return t?.topic}function kn(t){return typeof t<"u"&&typeof t!==null}const Jn="wc",uo=2,Vr="core",Et=`${Jn}@${2}:${Vr}:`,fo={name:Vr,logger:"error"},ho={database:":memory:"},lo="crypto",Zn="client_ed25519_seed",_o=De.ONE_DAY,go="keychain",yo="0.3",po="messages",bo="0.3",vo=De.SIX_HOURS,Eo="publisher",wo="irn",mo="error",Qn="wss://relay.walletconnect.com",Do="relayer",Ze={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},So="_subscription",br={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Oo=De.ONE_SECOND,$d={database:":memory:"},xo="2.5.2",To="0.3",dt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Fd=De.THIRTY_DAYS,Io="subscription",Ro="0.3",Ao=De.FIVE_SECONDS*1e3,Co="pairing",Po="0.3",Bd=De.THIRTY_DAYS,Xt={wc_pairingDelete:{req:{ttl:De.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:De.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:De.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:De.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:De.ONE_DAY,prompt:!1,tag:0},res:{ttl:De.ONE_DAY,prompt:!1,tag:0}}},_t={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Lo="history",No="0.3",Uo="expirer",ft={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Mo="0.3",zd=De.ONE_DAY;class jo{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=go,this.version=yo,this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=xe("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=Te.generateChildLogger(r,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ro(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?no(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class $o{constructor(e,r,n){this.core=e,this.logger=r,this.name=lo,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Rs(i);return Is(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=Zl();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),c=Rs(s),u=Vn();return await ol(u,i,_o,c)},this.generateSharedKey=(i,s,c)=>{this.isInitialized();const u=this.getPrivateKey(i),h=Ql(u,s);return this.setSymKey(h,c)},this.setSymKey=async(i,s)=>{this.isInitialized();const c=s||ed(i);return await this.keychain.set(c,i),c},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,c)=>{this.isInitialized();const u=ks(c),h=Sn(s);if(Js(u)){const v=u.senderPublicKey,b=u.receiverPublicKey;i=await this.generateSharedKey(v,b)}const f=this.getSymKey(i),{type:l,senderPublicKey:w}=u;return rd({type:l,symKey:f,message:h,senderPublicKey:w})},this.decode=async(i,s,c)=>{this.isInitialized();const u=sd(s,c);if(Js(u)){const l=u.receiverPublicKey,w=u.senderPublicKey;i=await this.generateSharedKey(l,w)}const h=this.getSymKey(i),f=nd({symKey:h,encoded:s});return Zi(f)},this.core=e,this.logger=Te.generateChildLogger(r,this.name),this.keychain=n||new jo(this.core,this.logger)}get context(){return Te.getLoggerContext(this.logger)}getPayloadType(e){const r=qn(e);return gr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Zn)}catch{e=Vn(),await this.keychain.set(Zn,e)}return nt(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Fo extends Gu{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=po,this.version=bo,this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=zr(i);let c=this.messages.get(n);return typeof c>"u"&&(c={}),typeof c[s]<"u"||(c[s]=i,this.messages.set(n,c),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),c=zr(i);return typeof s[c]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Te.generateChildLogger(e,this.name),this.core=r}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ro(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?no(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}const Hd="PARSE_ERROR",Kd="INVALID_REQUEST",Gd="METHOD_NOT_FOUND",Vd="INVALID_PARAMS",Bo="INTERNAL_ERROR",ei="SERVER_ERROR",qd=[-32700,-32600,-32601,-32602,-32603],vr={[Hd]:{code:-32700,message:"Parse error"},[Kd]:{code:-32600,message:"Invalid Request"},[Gd]:{code:-32601,message:"Method not found"},[Vd]:{code:-32602,message:"Invalid params"},[Bo]:{code:-32603,message:"Internal error"},[ei]:{code:-32e3,message:"Server error"}},zo=ei;function Wd(t){return qd.includes(t)}function Ho(t){return Object.keys(vr).includes(t)?vr[t]:vr[zo]}function Yd(t){const e=Object.values(vr).find(r=>r.code===t);return e||vr[zo]}function Xd(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Ko={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ti=function(t,e){return ti=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ti(t,e)};function kd(t,e){ti(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ri=function(){return ri=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ri.apply(this,arguments)};function Jd(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Zd(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Qd(t,e){return function(r,n){e(r,n,t)}}function e0(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function t0(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(l){try{f(n.next(l))}catch(w){c(w)}}function h(l){try{f(n.throw(l))}catch(w){c(w)}}function f(l){l.done?s(l.value):i(l.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function r0(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function n0(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function i0(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ni(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Go(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function s0(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Go(arguments[e]));return t}function o0(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function Er(t){return this instanceof Er?(this.v=t,this):new Er(t)}function a0(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(v){n[v]&&(i[v]=function(b){return new Promise(function(T,U){s.push([v,b,T,U])>1||u(v,b)})})}function u(v,b){try{h(n[v](b))}catch(T){w(s[0][3],T)}}function h(v){v.value instanceof Er?Promise.resolve(v.value.v).then(f,l):w(s[0][2],v)}function f(v){u("next",v)}function l(v){u("throw",v)}function w(v,b){v(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function c0(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:Er(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function u0(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ni=="function"?ni(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function f0(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function h0(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function l0(t){return t&&t.__esModule?t:{default:t}}function d0(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function _0(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var g0=Object.freeze({__proto__:null,__extends:kd,get __assign(){return ri},__rest:Jd,__decorate:Zd,__param:Qd,__metadata:e0,__awaiter:t0,__generator:r0,__createBinding:n0,__exportStar:i0,__values:ni,__read:Go,__spread:s0,__spreadArrays:o0,__await:Er,__asyncGenerator:a0,__asyncDelegator:c0,__asyncValues:u0,__makeTemplateObject:f0,__importStar:h0,__importDefault:l0,__classPrivateFieldGet:d0,__classPrivateFieldSet:_0}),y0=At(g0),wt={},Vo;function p0(){if(Vo)return wt;Vo=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.isBrowserCryptoAvailable=wt.getSubtleCrypto=wt.getBrowerCrypto=void 0;function t(){return ke?.crypto||ke?.msCrypto||{}}wt.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}wt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return wt.isBrowserCryptoAvailable=r,wt}var mt={},qo;function b0(){if(qo)return mt;qo=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.isBrowser=mt.isNode=mt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}mt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}mt.isNode=e;function r(){return!t()&&!e()}return mt.isBrowser=r,mt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=y0;e.__exportStar(p0(),t),e.__exportStar(b0(),t)})(Ko);function v0(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function ii(t,e,r){return{id:r||v0(),jsonrpc:"2.0",method:t,params:e}}function Wo(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Yo(t,e,r){return{id:t,jsonrpc:"2.0",error:E0(e,r)}}function E0(t,e){return typeof t>"u"?Ho(Bo):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ho(ei)),{message:t})),typeof e<"u"&&(t.data=e),Wd(t.code)&&(t=Yd(t.code)),t)}class w0{}class m0 extends w0{constructor(){super()}}class D0 extends m0{constructor(e){super()}}const S0="^wss?:";function O0(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function x0(t,e){const r=O0(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Xo(t){return x0(t,S0)}function T0(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function ko(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Jo(t){return ko(t)&&"method"in t}function Zo(t){return ko(t)&&(Qo(t)||qr(t))}function Qo(t){return"result"in t}function qr(t){return"error"in t}class I0 extends D0{constructor(e){super(e),this.events=new ut.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(ii(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{qr(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Zo(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const ea=10,R0=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),A0=()=>typeof window<"u",C0=R0();class P0{constructor(e){if(this.url=e,this.events=new ut.exports.EventEmitter,this.registering=!1,!Xo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Sn(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!Xo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Ko.isReactNative()?void 0:{rejectUnauthorized:!T0(e)},s=new C0(e,[],i);A0()?s.onerror=c=>{const u=c;n(this.emitError(u.error))}:s.on("error",c=>{n(this.emitError(c))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Zi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=Yo(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return Xd(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ea&&this.events.setMaxListeners(ea)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}class L0 extends Vu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ut.exports.EventEmitter,this.name=Eo,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const c=s?.ttl||vo,u=Xn(s),h=s?.prompt||!1,f=s?.tag||0,l={topic:n,message:i,opts:{ttl:c,relay:u,prompt:h,tag:f}},w=zr(i);this.queue.set(w,l);try{await await Hr(this.rpcPublish(n,i,c,u,h,f),this.publishTimeout),this.relayer.events.emit(Ze.publish,l)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ze.connection_stalled);return}this.onPublish(w,l),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(c){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(c),c}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=Te.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Te.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,s,c){var u,h,f,l;const w={method:Kr(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:s,tag:c}};return Gr((u=w.params)==null?void 0:u.prompt)&&((h=w.params)==null||delete h.prompt),Gr((f=w.params)==null?void 0:f.tag)&&((l=w.params)==null||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w}),this.relayer.request(w)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:i}=e;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(ir.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class N0{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var U0=Object.defineProperty,M0=Object.defineProperties,j0=Object.getOwnPropertyDescriptors,ta=Object.getOwnPropertySymbols,$0=Object.prototype.hasOwnProperty,F0=Object.prototype.propertyIsEnumerable,ra=(t,e,r)=>e in t?U0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wr=(t,e)=>{for(var r in e||(e={}))$0.call(e,r)&&ra(t,r,e[r]);if(ta)for(var r of ta(e))F0.call(e,r)&&ra(t,r,e[r]);return t},si=(t,e)=>M0(t,j0(e));class na extends Yu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new N0,this.events=new ut.exports.EventEmitter,this.name=Io,this.version=Ro,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Et,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=Xn(i),c={topic:n,relay:s};this.pending.set(n,c);const u=await this.rpcSubscribe(n,s);return this.onSubscribe(u,c),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),u}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const c=new De.Watch;c.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),i(!0)),c.elapsed(this.pendingSubscriptionWatchLabel)>=Ao&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pollingInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Te.generateChildLogger(r,this.name),this.clientId=""}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=Xn(n);await this.rpcUnsubscribe(e,r,i);const s=pr("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:Kr(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Hr(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ze.connection_stalled)}return zr(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:Kr(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Hr(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ze.connection_stalled)}}rpcUnsubscribe(e,r,n){const i={method:Kr(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,r){this.setSubscription(e,si(wr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,wr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,wr({},r)),this.topicMap.set(r.topic,e),this.events.emit(dt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(dt.deleted,si(wr({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(dt.sync)}async reset(){if(!this.cached.length)return;const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}this.events.emit(dt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);Nd(r)&&this.onBatchSubscribe(r.map((n,i)=>si(wr({},e[i]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(ir.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ze.connect,async()=>{await this.onConnect()}),this.relayer.on(Ze.disconnect,()=>{this.onDisconnect()}),this.events.on(dt.created,async e=>{const r=dt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(dt.deleted,async e=>{const r=dt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var B0=Object.defineProperty,ia=Object.getOwnPropertySymbols,z0=Object.prototype.hasOwnProperty,H0=Object.prototype.propertyIsEnumerable,sa=(t,e,r)=>e in t?B0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,K0=(t,e)=>{for(var r in e||(e={}))z0.call(e,r)&&sa(t,r,e[r]);if(ia)for(var r of ia(e))H0.call(e,r)&&sa(t,r,e[r]);return t};class oa extends qu{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ut.exports.EventEmitter,this.name=Do,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Te.generateChildLogger(e.logger,this.name):tn(Te.getDefaultLoggerOptions({level:e.logger||mo})),this.messages=new Fo(this.logger,e.core),this.subscriber=new na(this,this.logger),this.publisher=new L0(this,this.logger),this.relayUrl=e?.relayUrl||Qn,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Te.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(dt.created,s=>{s.topic===e&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(e,r),i()})]),n}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ze.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(dt.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,n)=>{await Hr(this.provider.connect(),5e3,"socket stalled").catch(i=>n(i)).then(()=>r()).finally(()=>this.removeListener(Ze.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Ze.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.events.emit(Ze.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new I0(new P0(bd({sdkVersion:xo,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Jo(e)){if(!e.method.endsWith(So))return;const r=e.params,{topic:n,message:i,publishedAt:s}=r.data,c={topic:n,message:i,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(K0({type:"event",event:r.id},c)),this.events.emit(r.id,c),await this.acknowledgePayload(e),await this.onMessageEvent(c)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ze.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Wo(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(br.payload,e=>this.onProviderPayload(e)),this.provider.on(br.connect,()=>{this.events.emit(Ze.connect)}),this.provider.on(br.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(br.error,e=>{this.logger.error(e),this.events.emit(Ze.error,e)})}registerEventListeners(){this.events.on(Ze.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ze.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},De.toMiliseconds(Oo))}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var oi={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,c=9007199254740991,u="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",l="[object Boolean]",w="[object Date]",v="[object Error]",b="[object Function]",T="[object GeneratorFunction]",U="[object Map]",L="[object Number]",K="[object Null]",S="[object Object]",I="[object Promise]",y="[object Proxy]",E="[object RegExp]",p="[object Set]",o="[object String]",_="[object Symbol]",j="[object Undefined]",F="[object WeakMap]",Y="[object ArrayBuffer]",k="[object DataView]",J="[object Float32Array]",A="[object Float64Array]",R="[object Int8Array]",q="[object Int16Array]",$="[object Int32Array]",P="[object Uint8Array]",N="[object Uint8ClampedArray]",M="[object Uint16Array]",B="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,W={};W[J]=W[A]=W[R]=W[q]=W[$]=W[P]=W[N]=W[M]=W[B]=!0,W[u]=W[h]=W[Y]=W[l]=W[k]=W[w]=W[v]=W[b]=W[U]=W[L]=W[S]=W[E]=W[p]=W[o]=W[F]=!1;var oe=typeof ke=="object"&&ke&&ke.Object===Object&&ke,x=typeof self=="object"&&self&&self.Object===Object&&self,O=oe||x||Function("return this")(),m=e&&!e.nodeType&&e,a=m&&!0&&t&&!t.nodeType&&t,g=a&&a.exports===m,H=g&&oe.process,G=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),fe=G&&G.isTypedArray;function ye(d,D){for(var C=-1,V=d==null?0:d.length,Ie=0,ne=[];++C<V;){var Ne=d[C];D(Ne,C,d)&&(ne[Ie++]=Ne)}return ne}function le(d,D){for(var C=-1,V=D.length,Ie=d.length;++C<V;)d[Ie+C]=D[C];return d}function ve(d,D){for(var C=-1,V=d==null?0:d.length;++C<V;)if(D(d[C],C,d))return!0;return!1}function Ue(d,D){for(var C=-1,V=Array(d);++C<d;)V[C]=D(C);return V}function Ce(d){return function(D){return d(D)}}function ge(d,D){return d.has(D)}function de(d,D){return d?.[D]}function he(d){var D=-1,C=Array(d.size);return d.forEach(function(V,Ie){C[++D]=[Ie,V]}),C}function ce(d,D){return function(C){return d(D(C))}}function ae(d){var D=-1,C=Array(d.size);return d.forEach(function(V){C[++D]=V}),C}var se=Array.prototype,ie=Function.prototype,Q=Object.prototype,ue=O["__core-js_shared__"],_e=ie.toString,te=Q.hasOwnProperty,pe=function(){var d=/[^.]+$/.exec(ue&&ue.keys&&ue.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),be=Q.toString,we=RegExp("^"+_e.call(te).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),me=g?O.Buffer:void 0,Ee=O.Symbol,gt=O.Uint8Array,vt=Q.propertyIsEnumerable,xt=se.splice,at=Ee?Ee.toStringTag:void 0,jt=Object.getOwnPropertySymbols,mr=me?me.isBuffer:void 0,Yr=ce(Object.keys,Object),Me=kt(O,"DataView"),Pe=kt(O,"Map"),je=kt(O,"Promise"),$e=kt(O,"Set"),Fe=kt(O,"WeakMap"),Le=kt(Object,"create"),He=Ft(Me),Ke=Ft(Pe),Ge=Ft(je),Ve=Ft($e),qe=Ft(Fe),ze=Ee?Ee.prototype:void 0,Be=ze?ze.valueOf:void 0;function Re(d){var D=-1,C=d==null?0:d.length;for(this.clear();++D<C;){var V=d[D];this.set(V[0],V[1])}}function We(){this.__data__=Le?Le(null):{},this.size=0}function Ye(d){var D=this.has(d)&&delete this.__data__[d];return this.size-=D?1:0,D}function Z0(d){var D=this.__data__;if(Le){var C=D[d];return C===n?void 0:C}return te.call(D,d)?D[d]:void 0}function Q0(d){var D=this.__data__;return Le?D[d]!==void 0:te.call(D,d)}function e_(d,D){var C=this.__data__;return this.size+=this.has(d)?0:1,C[d]=Le&&D===void 0?n:D,this}Re.prototype.clear=We,Re.prototype.delete=Ye,Re.prototype.get=Z0,Re.prototype.has=Q0,Re.prototype.set=e_;function Dt(d){var D=-1,C=d==null?0:d.length;for(this.clear();++D<C;){var V=d[D];this.set(V[0],V[1])}}function t_(){this.__data__=[],this.size=0}function r_(d){var D=this.__data__,C=kr(D,d);if(C<0)return!1;var V=D.length-1;return C==V?D.pop():xt.call(D,C,1),--this.size,!0}function n_(d){var D=this.__data__,C=kr(D,d);return C<0?void 0:D[C][1]}function i_(d){return kr(this.__data__,d)>-1}function s_(d,D){var C=this.__data__,V=kr(C,d);return V<0?(++this.size,C.push([d,D])):C[V][1]=D,this}Dt.prototype.clear=t_,Dt.prototype.delete=r_,Dt.prototype.get=n_,Dt.prototype.has=i_,Dt.prototype.set=s_;function $t(d){var D=-1,C=d==null?0:d.length;for(this.clear();++D<C;){var V=d[D];this.set(V[0],V[1])}}function o_(){this.size=0,this.__data__={hash:new Re,map:new(Pe||Dt),string:new Re}}function a_(d){var D=Jr(this,d).delete(d);return this.size-=D?1:0,D}function c_(d){return Jr(this,d).get(d)}function u_(d){return Jr(this,d).has(d)}function f_(d,D){var C=Jr(this,d),V=C.size;return C.set(d,D),this.size+=C.size==V?0:1,this}$t.prototype.clear=o_,$t.prototype.delete=a_,$t.prototype.get=c_,$t.prototype.has=u_,$t.prototype.set=f_;function Xr(d){var D=-1,C=d==null?0:d.length;for(this.__data__=new $t;++D<C;)this.add(d[D])}function h_(d){return this.__data__.set(d,n),this}function l_(d){return this.__data__.has(d)}Xr.prototype.add=Xr.prototype.push=h_,Xr.prototype.has=l_;function Tt(d){var D=this.__data__=new Dt(d);this.size=D.size}function d_(){this.__data__=new Dt,this.size=0}function __(d){var D=this.__data__,C=D.delete(d);return this.size=D.size,C}function g_(d){return this.__data__.get(d)}function y_(d){return this.__data__.has(d)}function p_(d,D){var C=this.__data__;if(C instanceof Dt){var V=C.__data__;if(!Pe||V.length<r-1)return V.push([d,D]),this.size=++C.size,this;C=this.__data__=new $t(V)}return C.set(d,D),this.size=C.size,this}Tt.prototype.clear=d_,Tt.prototype.delete=__,Tt.prototype.get=g_,Tt.prototype.has=y_,Tt.prototype.set=p_;function b_(d,D){var C=Zr(d),V=!C&&L_(d),Ie=!C&&!V&&ai(d),ne=!C&&!V&&!Ie&&Oa(d),Ne=C||V||Ie||ne,Xe=Ne?Ue(d.length,String):[],Qe=Xe.length;for(var Ae in d)(D||te.call(d,Ae))&&!(Ne&&(Ae=="length"||Ie&&(Ae=="offset"||Ae=="parent")||ne&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||I_(Ae,Qe)))&&Xe.push(Ae);return Xe}function kr(d,D){for(var C=d.length;C--;)if(wa(d[C][0],D))return C;return-1}function v_(d,D,C){var V=D(d);return Zr(d)?V:le(V,C(d))}function Dr(d){return d==null?d===void 0?j:K:at&&at in Object(d)?x_(d):P_(d)}function pa(d){return Sr(d)&&Dr(d)==u}function ba(d,D,C,V,Ie){return d===D?!0:d==null||D==null||!Sr(d)&&!Sr(D)?d!==d&&D!==D:E_(d,D,C,V,ba,Ie)}function E_(d,D,C,V,Ie,ne){var Ne=Zr(d),Xe=Zr(D),Qe=Ne?h:It(d),Ae=Xe?h:It(D);Qe=Qe==u?S:Qe,Ae=Ae==u?S:Ae;var ct=Qe==S,yt=Ae==S,tt=Qe==Ae;if(tt&&ai(d)){if(!ai(D))return!1;Ne=!0,ct=!1}if(tt&&!ct)return ne||(ne=new Tt),Ne||Oa(d)?va(d,D,C,V,Ie,ne):S_(d,D,Qe,C,V,Ie,ne);if(!(C&i)){var ht=ct&&te.call(d,"__wrapped__"),lt=yt&&te.call(D,"__wrapped__");if(ht||lt){var Rt=ht?d.value():d,St=lt?D.value():D;return ne||(ne=new Tt),Ie(Rt,St,C,V,ne)}}return tt?(ne||(ne=new Tt),O_(d,D,C,V,Ie,ne)):!1}function w_(d){if(!Sa(d)||A_(d))return!1;var D=ma(d)?we:z;return D.test(Ft(d))}function m_(d){return Sr(d)&&Da(d.length)&&!!W[Dr(d)]}function D_(d){if(!C_(d))return Yr(d);var D=[];for(var C in Object(d))te.call(d,C)&&C!="constructor"&&D.push(C);return D}function va(d,D,C,V,Ie,ne){var Ne=C&i,Xe=d.length,Qe=D.length;if(Xe!=Qe&&!(Ne&&Qe>Xe))return!1;var Ae=ne.get(d);if(Ae&&ne.get(D))return Ae==D;var ct=-1,yt=!0,tt=C&s?new Xr:void 0;for(ne.set(d,D),ne.set(D,d);++ct<Xe;){var ht=d[ct],lt=D[ct];if(V)var Rt=Ne?V(lt,ht,ct,D,d,ne):V(ht,lt,ct,d,D,ne);if(Rt!==void 0){if(Rt)continue;yt=!1;break}if(tt){if(!ve(D,function(St,Bt){if(!ge(tt,Bt)&&(ht===St||Ie(ht,St,C,V,ne)))return tt.push(Bt)})){yt=!1;break}}else if(!(ht===lt||Ie(ht,lt,C,V,ne))){yt=!1;break}}return ne.delete(d),ne.delete(D),yt}function S_(d,D,C,V,Ie,ne,Ne){switch(C){case k:if(d.byteLength!=D.byteLength||d.byteOffset!=D.byteOffset)return!1;d=d.buffer,D=D.buffer;case Y:return!(d.byteLength!=D.byteLength||!ne(new gt(d),new gt(D)));case l:case w:case L:return wa(+d,+D);case v:return d.name==D.name&&d.message==D.message;case E:case o:return d==D+"";case U:var Xe=he;case p:var Qe=V&i;if(Xe||(Xe=ae),d.size!=D.size&&!Qe)return!1;var Ae=Ne.get(d);if(Ae)return Ae==D;V|=s,Ne.set(d,D);var ct=va(Xe(d),Xe(D),V,Ie,ne,Ne);return Ne.delete(d),ct;case _:if(Be)return Be.call(d)==Be.call(D)}return!1}function O_(d,D,C,V,Ie,ne){var Ne=C&i,Xe=Ea(d),Qe=Xe.length,Ae=Ea(D),ct=Ae.length;if(Qe!=ct&&!Ne)return!1;for(var yt=Qe;yt--;){var tt=Xe[yt];if(!(Ne?tt in D:te.call(D,tt)))return!1}var ht=ne.get(d);if(ht&&ne.get(D))return ht==D;var lt=!0;ne.set(d,D),ne.set(D,d);for(var Rt=Ne;++yt<Qe;){tt=Xe[yt];var St=d[tt],Bt=D[tt];if(V)var xa=Ne?V(Bt,St,tt,D,d,ne):V(St,Bt,tt,d,D,ne);if(!(xa===void 0?St===Bt||Ie(St,Bt,C,V,ne):xa)){lt=!1;break}Rt||(Rt=tt=="constructor")}if(lt&&!Rt){var Qr=d.constructor,en=D.constructor;Qr!=en&&"constructor"in d&&"constructor"in D&&!(typeof Qr=="function"&&Qr instanceof Qr&&typeof en=="function"&&en instanceof en)&&(lt=!1)}return ne.delete(d),ne.delete(D),lt}function Ea(d){return v_(d,M_,T_)}function Jr(d,D){var C=d.__data__;return R_(D)?C[typeof D=="string"?"string":"hash"]:C.map}function kt(d,D){var C=de(d,D);return w_(C)?C:void 0}function x_(d){var D=te.call(d,at),C=d[at];try{d[at]=void 0;var V=!0}catch{}var Ie=be.call(d);return V&&(D?d[at]=C:delete d[at]),Ie}var T_=jt?function(d){return d==null?[]:(d=Object(d),ye(jt(d),function(D){return vt.call(d,D)}))}:j_,It=Dr;(Me&&It(new Me(new ArrayBuffer(1)))!=k||Pe&&It(new Pe)!=U||je&&It(je.resolve())!=I||$e&&It(new $e)!=p||Fe&&It(new Fe)!=F)&&(It=function(d){var D=Dr(d),C=D==S?d.constructor:void 0,V=C?Ft(C):"";if(V)switch(V){case He:return k;case Ke:return U;case Ge:return I;case Ve:return p;case qe:return F}return D});function I_(d,D){return D=D??c,!!D&&(typeof d=="number"||Z.test(d))&&d>-1&&d%1==0&&d<D}function R_(d){var D=typeof d;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?d!=="__proto__":d===null}function A_(d){return!!pe&&pe in d}function C_(d){var D=d&&d.constructor,C=typeof D=="function"&&D.prototype||Q;return d===C}function P_(d){return be.call(d)}function Ft(d){if(d!=null){try{return _e.call(d)}catch{}try{return d+""}catch{}}return""}function wa(d,D){return d===D||d!==d&&D!==D}var L_=pa(function(){return arguments}())?pa:function(d){return Sr(d)&&te.call(d,"callee")&&!vt.call(d,"callee")},Zr=Array.isArray;function N_(d){return d!=null&&Da(d.length)&&!ma(d)}var ai=mr||$_;function U_(d,D){return ba(d,D)}function ma(d){if(!Sa(d))return!1;var D=Dr(d);return D==b||D==T||D==f||D==y}function Da(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=c}function Sa(d){var D=typeof d;return d!=null&&(D=="object"||D=="function")}function Sr(d){return d!=null&&typeof d=="object"}var Oa=fe?Ce(fe):m_;function M_(d){return N_(d)?b_(d):D_(d)}function j_(){return[]}function $_(){return!1}t.exports=U_})(oi,oi.exports);var G0=oi.exports,V0=Object.defineProperty,aa=Object.getOwnPropertySymbols,q0=Object.prototype.hasOwnProperty,W0=Object.prototype.propertyIsEnumerable,ca=(t,e,r)=>e in t?V0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ua=(t,e)=>{for(var r in e||(e={}))q0.call(e,r)&&ca(t,r,e[r]);if(aa)for(var r of aa(e))W0.call(e,r)&&ca(t,r,e[r]);return t};class fa extends Wu{constructor(e,r,n,i=Et,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=To,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(c=>{this.getKey&&c!==null&&!Gr(c)?this.map.set(this.getKey(c),c):Md(c)?this.map.set(c.id,c):jd(c)&&this.map.set(c.topic,c)}),this.cached=[],this.initialized=!0)},this.set=async(c,u)=>{this.isInitialized(),this.map.has(c)?await this.update(c,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:c,value:u}),this.map.set(c,u),await this.persist())},this.get=c=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:c}),this.getData(c)),this.getAll=c=>(this.isInitialized(),c?this.values.filter(u=>Object.keys(c).every(h=>G0(u[h],c[h]))):this.values),this.update=async(c,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:c,update:u});const h=ua(ua({},this.getData(c)),u);this.map.set(c,h),await this.persist()},this.delete=async(c,u)=>{this.isInitialized(),this.map.has(c)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:c,reason:u}),this.map.delete(c),await this.persist())},this.logger=Te.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ha{constructor(e,r){this.core=e,this.logger=r,this.name=Co,this.version=Po,this.events=new ut.exports,this.initialized=!1,this.storagePrefix=Et,this.ignoredPayloadTypes=[Yt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Vn(),i=await this.core.crypto.setSymKey(n),s=Wn(De.FIVE_MINUTES),c={protocol:wo},u={topic:i,expiry:s,relay:c,active:!1},h=Cd({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:c});return await this.pairings.set(i,u),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:h}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:c}=Rd(n.uri);if(this.pairings.keys.includes(i))throw new Error(`Pairing already exists: ${i}`);if(this.core.crypto.hasKeys(i))throw new Error(`Keychain already exists: ${i}`);const u=Wn(De.FIVE_MINUTES),h={topic:i,relay:c,expiry:u,active:!1};return await this.pairings.set(i,h),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:c}),this.core.expirer.set(i,u),n.activatePairing&&await this.activate({topic:i}),h},this.activate=async({topic:n})=>{this.isInitialized();const i=Wn(De.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:c,resolve:u,reject:h}=vd();this.events.once(Yn("pairing_ping",s),({error:f})=>{f?h(f):u()}),await c()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",pr("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const c=ii(i,s),u=await this.core.crypto.encode(n,c),h=Xt[i].req;return this.core.history.set(n,c),await this.core.relayer.publish(n,u,h),c.id},this.sendResult=async(n,i,s)=>{const c=Wo(n,s),u=await this.core.crypto.encode(i,c),h=await this.core.history.get(i,n),f=Xt[h.request.method].res;await this.core.relayer.publish(i,u,f),await this.core.history.resolve(c)},this.sendError=async(n,i,s)=>{const c=Yo(n,s),u=await this.core.crypto.encode(i,c),h=await this.core.history.get(i,n),f=Xt[h.request.method]?Xt[h.request.method].res:Xt.unregistered_method.res;await this.core.relayer.publish(i,u,f),await this.core.history.resolve(c)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,pr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>so(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,c=s.method;if(this.pairings.keys.includes(i))switch(c){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,c=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(c){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(c)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{Qo(i)?this.events.emit(Yn("pairing_ping",s),{}):qr(i)&&this.events.emit(Yn("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:c}=i;try{if(this.registeredMethods.includes(c))return;const u=pr("WC_METHOD_UNSUPPORTED",c);await this.sendError(s,n,u),this.logger.error(u)}catch(u){await this.sendError(s,n,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(pr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!kn(n)){const{message:i}=xe("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!Ud(n.uri)){const{message:i}=xe("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!kn(n)){const{message:s}=xe("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!kn(n)){const{message:s}=xe("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!co(n,!1)){const{message:i}=xe("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=xe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(so(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=xe("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=Te.generateChildLogger(r,this.name),this.pairings=new fa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Te.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ze.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Jo(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Zo(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(ft.expired,async e=>{const{topic:r}=md(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class la extends Ku{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ut.exports.EventEmitter,this.name=Lo,this.version=No,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const c={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(c.id,c),this.events.emit(_t.created,c)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=qr(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(_t.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(_t.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Te.generateChildLogger(r,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:ii(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(_t.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(_t.created,e=>{const r=_t.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(_t.updated,e=>{const r=_t.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(_t.deleted,e=>{const r=_t.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class da extends Xu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ut.exports.EventEmitter,this.name=Uo,this.version=Mo,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),c={target:s,expiry:i};this.expirations.set(s,c),this.checkExpiry(s,c),this.events.emit(ft.created,{target:s,expiration:c})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(ft.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Te.generateChildLogger(r,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Ed(e);if(typeof e=="number")return wd(e);const{message:r}=xe("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ft.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;De.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(ft.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(ir.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(ft.created,e=>{const r=ft.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ft.expired,e=>{const r=ft.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ft.deleted,e=>{const r=ft.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Y0=Object.defineProperty,_a=Object.getOwnPropertySymbols,X0=Object.prototype.hasOwnProperty,k0=Object.prototype.propertyIsEnumerable,ga=(t,e,r)=>e in t?Y0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ya=(t,e)=>{for(var r in e||(e={}))X0.call(e,r)&&ga(t,r,e[r]);if(_a)for(var r of _a(e))k0.call(e,r)&&ga(t,r,e[r]);return t};class Wr extends Hu{constructor(e){super(e),this.protocol=Jn,this.version=uo,this.name=Vr,this.events=new ut.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Qn;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:tn(Te.getDefaultLoggerOptions({level:e?.logger||fo.logger}));this.logger=Te.generateChildLogger(r,this.name),this.heartbeat=new ir.HeartBeat,this.crypto=new $o(this,this.logger,e?.keychain),this.history=new la(this,this.logger),this.expirer=new da(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Ec(ya(ya({},ho),e?.storageOptions)),this.relayer=new oa({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new ha(this,this.logger)}static async init(e){const r=new Wr(e);return await r.initialize(),r}get context(){return Te.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const J0=Wr;X.CORE_CONTEXT=Vr,X.CORE_DEFAULT=fo,X.CORE_PROTOCOL=Jn,X.CORE_STORAGE_OPTIONS=ho,X.CORE_STORAGE_PREFIX=Et,X.CORE_VERSION=uo,X.CRYPTO_CLIENT_SEED=Zn,X.CRYPTO_CONTEXT=lo,X.CRYPTO_JWT_TTL=_o,X.Core=J0,X.Crypto=$o,X.EXPIRER_CONTEXT=Uo,X.EXPIRER_DEFAULT_TTL=zd,X.EXPIRER_EVENTS=ft,X.EXPIRER_STORAGE_VERSION=Mo,X.Expirer=da,X.HISTORY_CONTEXT=Lo,X.HISTORY_EVENTS=_t,X.HISTORY_STORAGE_VERSION=No,X.JsonRpcHistory=la,X.KEYCHAIN_CONTEXT=go,X.KEYCHAIN_STORAGE_VERSION=yo,X.KeyChain=jo,X.MESSAGES_CONTEXT=po,X.MESSAGES_STORAGE_VERSION=bo,X.MessageTracker=Fo,X.PAIRING_CONTEXT=Co,X.PAIRING_DEFAULT_TTL=Bd,X.PAIRING_RPC_OPTS=Xt,X.PAIRING_STORAGE_VERSION=Po,X.PENDING_SUB_RESOLUTION_TIMEOUT=Ao,X.PUBLISHER_CONTEXT=Eo,X.PUBLISHER_DEFAULT_TTL=vo,X.Pairing=ha,X.RELAYER_CONTEXT=Do,X.RELAYER_DEFAULT_LOGGER=mo,X.RELAYER_DEFAULT_PROTOCOL=wo,X.RELAYER_DEFAULT_RELAY_URL=Qn,X.RELAYER_EVENTS=Ze,X.RELAYER_PROVIDER_EVENTS=br,X.RELAYER_RECONNECT_TIMEOUT=Oo,X.RELAYER_SDK_VERSION=xo,X.RELAYER_STORAGE_OPTIONS=$d,X.RELAYER_SUBSCRIBER_SUFFIX=So,X.Relayer=oa,X.STORE_STORAGE_VERSION=To,X.SUBSCRIBER_CONTEXT=Io,X.SUBSCRIBER_DEFAULT_TTL=Fd,X.SUBSCRIBER_EVENTS=dt,X.SUBSCRIBER_STORAGE_VERSION=Ro,X.Store=fa,X.Subscriber=na,X.default=Wr,Object.defineProperty(X,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
